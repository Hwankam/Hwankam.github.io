<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="ISLR chap 6" /><meta property="og:locale" content="en" /><meta name="description" content="6. Linear Model Selection and Regularization" /><meta property="og:description" content="6. Linear Model Selection and Regularization" /><link rel="canonical" href="https://hwankam.github.io/posts/ISLR6/" /><meta property="og:url" content="https://hwankam.github.io/posts/ISLR6/" /><meta property="og:site_name" content="For Statistics" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-04T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ISLR chap 6" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"6. Linear Model Selection and Regularization","url":"https://hwankam.github.io/posts/ISLR6/","headline":"ISLR chap 6","dateModified":"2021-11-07T17:37:44+09:00","datePublished":"2021-08-04T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://hwankam.github.io/posts/ISLR6/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>ISLR chap 6 | For Statistics</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="For Statistics"><meta name="application-name" content="For Statistics"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">For Statistics</a></div><div class="site-subtitle font-italic">kam's world</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Hwankam" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>ISLR chap 6</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>ISLR chap 6</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> your_full_name </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Aug 4, 2021, 12:00 AM +0900" >Aug 4, 2021<i class="unloaded">2021-08-04T00:00:00+09:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Nov 7, 2021, 5:37 PM +0900" >Nov 7, 2021<i class="unloaded">2021-11-07T17:37:44+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4475 words">24 min read</span></div></div><div class="post-content"><h3 id="6-linear-model-selection-and-regularization">6. Linear Model Selection and Regularization</h3><h4 id="61-subset-selection">6.1 Subset Selection</h4><p>inference(모델의 해석력, 직관성)이 좋은 선형모델을 다른 방식으로 fitting 할 수는 없을까?</p><p>(1) subset selection</p><p>domain 지식, 혹은 계수에 대한 유의성 검정 결과 등으로 불필요한 변수를 제거 할 수 있을 것이다.</p><p>(2) shrinkage</p><p>특정 변수에 대한 회귀계수를 0에 가깝게 만들어줌으로써, 분산을 줄일 수 있고 특히 Lasso는 아예 계수값을 0으로 만들어 변수 선택과 같은 효과를 가져오게 한다.</p><p>(3) dimension reduction(p –&gt; m)</p><p>p개의 변수를 m개의 linear combination으로 표현한다든지, 혹은 projection을 통해서 변수의 개수를 m개로 줄여 이를 이용해 최소제곱법으로 모형 적합.</p><p>다른 방식으로 얻을 수 있는 것은?</p><p>(1) prediction accuracy</p><p>선형모형은 데이터셋이 많고, true 모형이 선형일 때에 뛰어난 성능을 발휘. but 그렇지 않은 경우 선형모형에 적합을 시키면 과적합이 발생. 이를 방지하기 위해, 회귀 계수에 constraining or shrinkage를 줌으로써 예측 성능을 높일 수 있다.</p><p>(2) 필요없는 변수의 계수 값을 0으로 만들어줌으로써 모델의 복잡성을 줄이고 해석력을 높일 수 있다.</p><h5 id="611-best-subset-selection">6.1.1 Best Subset Selection</h5><p>p개 변수(여기서 p가 연속형 변수)인 경우 \(2^p\) 번 모형을 적합시켜서 최고의 모델을 선택하기. 그런데 p가 크면 모형 개수가 너무 많아진다.</p><p>알고리즘은 아래와 같다.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr6-1.png" width="70%" height="70%" title="1" alt="relative" /></p><p>핵심은 각 변수 개수 별로 최고의 모델을 찾은 다음에(기준 RSS, R-square ※ 이 기준은 변수 개수가 같을 때 쓰는 것이다. 변수가 증가하면 R-square는 필연적으로 증가하기 때문에 변수 개수가 동일 할 때 선택 기준 ), 그 중에서 예측력이 좋은, 즉 cross-validated prediction error, mallow-cp, AIC, BIC, adjusted R-square 가 높은 모델을 선택.</p><h5 id="612-stepwise-selection">6.1.2. Stepwise Selection</h5><p>단순한 forward, backward와는 조금 다르다</p><p>forward stepwise selection을 가지고 설명하자면,</p><p>변수가 없는 초기모델에서</p><p>변수가 하나만 있는 모델에서 RSS나 R-square 가 제일 나은 모델을 선택하고</p><p>그 모델을 기준으로 또 변수를 하나 더 추가해서 그 중 RSS나 R-square 가 제일 나은 모델을 선택</p><p>이 과정을 반복해서 변수의 개수 별로 최적 모델을 찾은 다음에 그 중 예측력이 좋은, 즉 cross-validated prediction error, mallow-cp, AIC, BIC, adjusted R-square 가 높은 모델을 선택.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr6-2.png" width="70%" height="70%" title="1" alt="relative" /></p><p>backward stepwise selection은 그 반대</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr6-3.png" width="70%" height="70%" title="1" alt="relative" /></p><p>subset selection method 보다 계산량이 줄어든다. 그러나 첫번째 선택한 변수를 기반으로 다음 변수가 선택되기 때문에 최적의 모델(변수)를 찾지 못할 수도 있다.</p><p>또한 forward 방법은 backward와 다르게 high dimension(n&lt;p)에서도 적용 가능하다.</p><p>이를 섞어놓은 hybrid approach도 존재</p><h5 id="613-choosing-the-optimal-model">6.1.3 Choosing the Optimal Model</h5><p>(1) <u>indirectly</u> estimate test error by <strong>making an adjustment to the training error</strong> to account for bias</p><h6 id="c_p">C_p</h6><p>$ C_p = \frac {1}{n}(RSS + 2p \hat \sigma^2) $</p><p>p는 변수의 개수를 의미</p><p>뒷 항이 변수의 개수에 대한 penalty를 주는 것으로 변수의 개수가 많아지면 뒷 항은 커진다. 그리고 C_p 값은 작아야 좋으며 분산 추정량 sigma^2는 불편추정량이므로 C_p는 test MSE에 대한 불편추정량이다.</p><p>$ mallow’s \ c_p = RSS/\hat \sigma^2 + 2p -n \ =\ \hat \sigma^2(C_p + n) $</p><h6 id="aic">AIC</h6><p>maximum likelihood를 사용해서 적합성을 설명.</p><p>$ AIC = \frac {1}{n\hat \sigma^2}(RSS + 2p\hat\sigma^2) $</p><p>식에서도 알 수 있듯, C_p와 비례하기 때문에 설명 생략</p><h6 id="bic">BIC</h6><p>베이지안 관점</p><p>$ BIC = \frac {1}{n} (RSS + log(n)p\hat\sigma^2) $</p><p>C_p 와의 차이는 n의 크기가 커질수록, 즉 데이터 개수가 많아질 수록 변수 개수에 대한 penalty를 더욱 크게 주는 것이다. 따라서 C_p에 비해서 더욱 변수 개수가 작은 모형을 선택하려고 할 것이다.</p><p>※여기서는 선형모형의 최소제곱법을 기준으로 모형을 적합하기 때문에 RSS로 썼는데 AIC, BIC의 일반적인 수식은 아래와 같다</p><p>$ -2 logL + kp,\ \ L \ is\ likelihood $</p><p>AIC는 k=2, BIC는 k=log(n)</p><h6 id="adjusted-r-square">adjusted R-square</h6><p>$ Adjusted \ R^2 \ = \ 1 - \frac {RSS/(n-p-1)}{TSS / (n-1)} $</p><p>앞서 본 C_p, AIC, BIC와는 다르게 adjusted R-square는 큰 값일 수록 모형적합 및 예측이 뛰어난 것이다.</p><p>(2) <u>directly</u> estimate the test error using validation set or CV</p><p>따로 가정이 필요없고 test error rate을 직접 추론한다. 과거에는 대용량의 계산이 어려워서 C_p, AIC, BIC 등을 사용했지만, 컴퓨팅 기술이 발달한 현재 CV가 모델 선택에 있어 훨씬 좋다.</p><p>앞 장에서도 설명했듯, CV, Validation set error 는 valid set을 어떻게 설정하는지에 따라 test mse 값이 바뀔 수 있다. 즉 test mse를 최소로 하는 변수의 개수 또한 바뀔 수 있다. 그럼 변수 개수를 어떻게 해야 최적의 모델을 고를 수 있을까? 이때는 one-standard-error라는 조건으로 모형을 결정한다.</p><p>아래 그림은 CMU-STAT 383C - Statistical Modeling 1 Lecture 9 강의노트에서 캡쳐해온 것이다</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr6-4.png" width="70%" height="70%" title="1" alt="relative" /></p><p>즉 CV의 결과로 변수 개수에 따른 test error rate을 구했다고 하자. 이 때 error를 최소로 하는 값에 대한 1 standard error 범위에 속한 모델(변수 개수) 중 가장 단순한 모델(변수 개수가 가장 작은 모델)을 선택한다.</p><h4 id="62-shrinkage-methods">6.2 Shrinkage Methods</h4><p>분산을 줄여준다!</p><h5 id="621-ridge-regression">6.2.1 Ridge Regression</h5><p>tuning parameter lambda를 사용해서 \(\sum (y_i - X\beta)^2 + \lambda\sum\beta_j^2\) 를 minimize 하는 \(\hat \beta ^R\) 를 추정하는 것.</p><p>penalty 항이 존재해서 RSS를 계속해서 줄여나가지 않고 penalty 값을 줄여나가려고 한다.</p><p>tuning parameter lambda는 penalty항의 크기를 결정함으로서 계수 추정값을 변화시키는데</p><p>그 값이 커지면서 규제(regulation)의 효과가 커지고 계수 추정량이 0에 가까워 질 것이다. 따라서 lambda값을 적절히 설정하는 것이 중요하다.</p><p>또한 predictor 값이 모두 0일 때의 response를 나타내는 intercept Beta_0는 shrinkage에 영향을 받지 않으며 만약 데이터들이 centered 된다면 절편 추정량은 response의 표본평균이 될 것이다.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr6-5.png" width="70%" height="70%" title="1" alt="relative" /></p><p>그림에서 보듯 적절한 lambda 값을 통해 규제를 주면 전혀 불필요한 변수들에 대한 계수값이 0이 되면서 분산이 줄어들고 fit도 더 잘되어 MSE가 줄어들 수 있다. 특히 \(X'X\) 에 대한 가장 큰 고유벡터 방향이 회귀 계수 beta 값과 일치한다면 MSE의 향상이 더 좋을 것이다. (몽고메리 부분 참고)</p><p>또한 ridge에 의해 회귀계수가 축소가 되기 때문에 ridge 이전에 변수들의 scaling을 조절하는 것이 중요하다. 그렇지 않으면 (scale과 lambda값 둘 다에 영향을 받게 되어 오류가 생길 수 있음)</p><p>그렇다면 왜 Ridge regression이 least square 보다 좋은 것일까?</p><p>==&gt; bias - variance trade off</p><p>variance를 크게 줄임으로서 test MSE를 줄일 수 있다.</p><p>분산이 커지는 두가지 케이스</p><p>(1) predictor와 response가 서로 선형이라면 이들 관계는 특정한 값에 의해 크게 바뀔 수 있다. 즉 분산이 커질 우려가 있다. (2) 또한 high dimension (p&gt;n) 인 경우 least square 계수 추정량은 유일하지 않다.</p><p>이 때 ridge regression을 사용하면 분산을 안정화시킬 수 있다.</p><p>또한 변수 선택의 관점에서도 ridge를 사용하면 best subset을 하나하나 찾는것 보다 훨씬 비용이 절감되고 계산량이 줄어든다.</p><h5 id="622-the-lasso">6.2.2 The Lasso</h5><p>Ridge 의 단점은 모든 변수가 모형에 들어간다는 것이다. 그것의 계수가 비록 매우 작은 값일지라도…. 따라서 예측의 문제보다는 모형 자체의 해석을 할 때 단순하게 만들어진 모델에 비해 복잡할 것이다. 이러한 점을 고려해서 Lasso regresssion이 나오게 되었다.</p><p>$ \sum (y_i - X\beta)^2 + \lambda\sum|\beta_j| $</p><p>Lasso 는 계수값을 완전히 0으로 만드는데 이는 variable selection의 일종이라 볼 수도 있으며, Ridge에 비해 모델 해석이 쉽다(model interpretation , inference)</p><p>또한 ridge 처럼 lambda값을 잘 구하는 것이 중요한데, 이에 대한 것은 6.2.3에서 설명하도록 하겠다.</p><h6 id="another-formulation-for-ridge-and-lasso">Another Formulation for Ridge and Lasso</h6><p>라그랑주를 사용해서 다음과 같이 표현할 수 있다.</p><p>$ minimize \ \sum (y_i - X\beta)^2 \ \ \ subject \ \ to \ \ \sum\beta_j^2 \leq s $</p><p>$ minimize \ \sum (y_i - X\beta)^2 \ \ \ subject \ \ to \ \ \sum|\beta_j| \leq s $</p><p>이러한 방식으로 best subset selection 방식도 표현 가능한데, 단 계산량이 너무 많아서 ridge 나 lasso가 좋고, 변수 선택에 입장에서는 ridge 보다는 lasso 가 더 좋은 역할을 하게 된다.</p><p>$ minimize \ \sum (y_i - X\beta)^2 \ \ \ subject \ \ to \ \ \sum I(\beta_j \neq 0) \leq s $</p><h6 id="variable-selection-property-of-the-lasso">Variable Selection Property of the Lasso</h6><p>어떻게 Lasso는 계수값을 정확히 0으로 만드는 것일까? 아래 그림을 보자</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr6-6.png" width="70%" height="70%" title="1" alt="relative" /></p><p>그림에서 보면 알 수 있듯 lasso 의 경우 코너해에서 회귀계수가 결정되는 양상을 보인다.</p><h6 id="comparing-lasso-and-ridge">comparing Lasso and Ridge</h6><p>해석력의 관점에서는 lasso가 좋다 (변수 자체가 작아지니까) 그럼 prediction 관점에서는??</p><p>ridge나 lasso 모두 lambda 값에 의해 bias-variance trade-off 관계가 발생하고 lambda 값이 커지면서 분산이 안정화 된다. 다만 어떤 방식이 더 낮은 test error rate을 가질지는 데이터의 형태에 따라 다르고 변수의 개수에 따라서도 다르다.</p><p>일반적으로 계수값의 편차가 큰 경우에는 Lasso가 그렇지 않은 경우에는 Ridge가 더 좋은 prediction을 갖는다.</p><h6 id="bayesian-interpretation-for-ridge-and-lasso">Bayesian Interpretation for Ridge and Lasso</h6><p>bayes’ theorem 그대로 이용해서 posterior의 mode값을 계수 추정량으로 선택</p><p>$ P(\beta | X, Y) \propto f(Y|X, \beta ) P(\beta) $</p><p>likelihood는 선형모델로 고정, epsilon은 iid 성질을 가진 normal</p><p>$ Y = X\beta + \epsilon $</p><p>prior는 $ P(\beta) = \prod g(\beta_j) $</p><p>이 때</p><p>ridge는 g가 Gaussian with mean zero and standard deviation a function of lambda.</p><p>lasso는 g가 Double-Exponential with mean zero and scale parameter a function of lambda</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr6-7.png" width="70%" height="70%" title="1" alt="relative" /></p><h5 id="623-choosing-the-tuning-parameter">6.2.3 Choosing the Tuning Parameter</h5><p>lambda를 어떻게 설정할 것인가?</p><p>==&gt; grid search. 후보를 정해놓고 cross-validation 결과 나온 error 값 중 가장 낮은 error를 갖는 lambda를 선택한다.</p><h4 id="63-dimension-reduction-methods">6.3 Dimension Reduction Methods</h4><p>앞에서 분산을 줄이는 과정으로 predictor의 subset을 선택한다던지, ridge 혹은 lasso를 하는 방식을 설명했다. 여기에서는 적합시키는 predictor 자체를 바꾸는 방법을 설명하겠다.</p><p>기본 틀은 다음과 같다</p><p>(1) 기존 확률변수 \(X_1, X_2, ... , X_p\) 에 대해서 M&lt;p 인 M개의 \(Z_1, Z_2, ...,Z_M\) 변수를 X들의 linear combination으로 만들어 낸다</p><p>$ Z_m = \sum_{j=1} ^p \phi_{jm}X_j $</p><p>(2) 이제 확률변수 Z를 가지고 적합을 한다. lienar 모델인 경우 \(y_i = \theta_0 + \sum_{m=1} ^M \theta_m Z_{im} + \epsilon_i, \ \ \ \ \ \ i=1,2,...,n\)</p><p>(3) phi 값을 어떻게 설정할 것인지에 대해서는 두가지 방법이 존재한다. (6.3.1 / 6.3.2)</p><h5 id="631-principal-components-regression">6.3.1 Principal Components Regression</h5><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr6-8.png" width="70%" height="70%" title="1" alt="relative" /></p><p>가장 큰 분산을 가지는 green line : the first principal component</p><p>수식을 통해 좀 더 자세히 살펴보자.</p><p>formula :</p><p>$ Z_1 = \phi_1 \times(X_1-\bar X_1) + \phi_2 \times(X_2-\bar X_2) $</p><p>여기서 Z 값이 principal component score이며 Z_1의 분산이 가장 크다.</p><p>또한 ,이 때 \(\phi\) 값은 principal component loading이며 \(\sum \phi_i^2 = 1\) 이라는 성질을 갖는다.(이러한 제약이 없다면 임의로 분산을 마구 키울 수 있기 때문)</p><p>PCA에 대한 또 다른 해석으로는 첫번째 PC가 sum of the squared perpendicular distance를 최소화 하는 line이라는 것이다. 즉 데이터와 가능한 가장 가까운 직선을 긋는 것이라 볼 수 있다.</p><h6 id="principal-components-regression-approach">Principal Components Regression Approach</h6><p>아마 PCA를 공부하면서도 가장 중요한 문장이 나온다</p><p>“<strong>The key idea is that often a small number of principal components suffice to explain most of the variability in the data</strong>”</p><p>즉 분산이 큰 방향을 축으로 데이터를 사영시켰을 때 나오는 principal component 몇개를 가지고 데이터를 충분히 설명할 수 있다면 이를 변수로 삼아 Y와의 관계를 찾을 때 fitting이 더 좋다는 것이다.(변수 개수가 작으니까 당연히 오버피팅도 막을 수 있고) (<u>단, PCA를 통해 차원의 축소가 잘 안된다면 그냥 원래 데이터를 가지고 ridge나 lasso를 하는 것이 훨씬 fitting이 잘 될수 있다.</u>)</p><p>pca를 통해 축소가 잘 안되는 경우? 데이터의 변수가 원래 작아서 각각이 모두 의미를 담고 있는 경우</p><p>참고 : PCR은 Ridge regression과 매우 유사하며 Ridge가 PCR의 연장선상에 있다고도 볼 수 있다</p><h6 id="how-to-find-the-number-of-principal-components">how to find the number of principal components</h6><p>PCR에서 적절한 변수의 개수는 어떻게 찾을 것인가.</p><p>Principal component score 들은 크기에 따라 순차적으로 정해지고 PC line은 서로 직교하게 만들어진다. 그런데 만약 다음 score 값이 거의 0에 근사한다는 것은 이전의 principal component를 가지고 데이터를 충분히 설명가능하다는 말이다.</p><p>그러나 이는 다소 모호하다</p><p>확실한 기준을 위해선 CV를 통해서 test mse를 최소로 하는 변수 개수를 선택하면 될 것이다.</p><h6 id="final-check">final check</h6><p>PCR은 데이터의 분산을 다루는 것이므로 scale에 민감하다. 따라서 PCR을 수행하기 전에는 반드시 데이터들을 정규화해주어야 한다!</p><h5 id="632-partial-least-squares">6.3.2 Partial Least Squares</h5><p>PCR은 PC direction을 찾는 데에 Y(target) 값을 전혀 이용하지 않는다. un-supervised way</p><p>따라서 PCR을 하면서 찾은 best direction이 실제로 best가 아닐 수 있다.</p><p>==&gt; Y를 고려해서 차원을 축소하는 지도학습법 partial least square가 등장.</p><p>요약 : PLS를 통해서 response와 predictor를 동시에 설명하는 direction을 찾자!</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr6-9.png" width="70%" height="70%" title="1" alt="relative" /></p><p>step 1</p><p>PCR과 마찬가지로 표준화를 먼저 한다. 단 PLS는 response 를 같이 고려하기 때문에 response variable 또한 표준화 해줘야 한다.</p><p>step 2</p><p>simple linear regression Y onto X_i ( i = 1,2, … , p) 에서 나온 각 변수들에 대한 계수 값(phi)을 가지고 새로운 변수 Z_1을 만들어 낸다. 즉,</p><p>$ Z_1 = \sum \phi_iX_i $</p><p>이렇게 하면 Y와 큰 상관관계를 가지는 변수에 대해 큰 weight를 줄 수 있다.</p><p>step 3</p><p>second PLS direction을 만들기 위해 simple linear regression X_i onto Z_1</p><p>여기서 나온 잔차들은 각 변수들에서 Z_1이 설명하지 못하는 부분이다. 이 residual을 다시 X와 simple linear regression 해서 나오는 계수를 가지고 Z_2를 만든다. 이 과정을 반복한다.</p><p>step 4</p><p>차원을 얼마나 축소할 수 있을까? CV를 사용해라.</p><h4 id="64-considerations-in-high-dimensions">6.4 Considerations in High Dimensions</h4><h5 id="641-high-dimensional-data">6.4.1 High-Dimensional Data</h5><p>다양한 정보를 얻게 되면서 데이터 분석에서 이용되는 feature가 많아졌다. n보다 p가 더 큰 경우 오버피팅의 문제가 발생한다.</p><h5 id="642-what-goes-wrong-in-high-dimensions">6.4.2 What Goes Wrong in High Dimensions?</h5><p>overfitting ==&gt; 예측력이 떨어짐</p><p>예측력의 평가지표인 C_p, AIC, BIC 등을 계산하는 데에 문제가 있음. 왜? error의 분산인 sigma 값을 추정하기 어렵기 때문에.</p><p>adjusted R-square 또한 계산이 어려움. high dimension인 경우 과적합 발생으로 R-square가 1일수도 있기 때문</p><h5 id="643-regression-in-high-dimensions">6.4.3 Regression in High Dimensions</h5><p>변수선택이나 차원 축소를 통해서 high dimension 문제를 해결할 수 있다.</p><p>차원의 저주? 흔히 feature를 많이 넣으면 fitting의 결과도 좋을 것이라 생각한다. 이것은 일부는 맞다. target과 관련이 큰 feature를 집어넣으면 그리고 이 데이터들의 noise가 작다면 성능이 좋아질 수 있다. 그러나 만일 추가된 feature가 noise가 많아 target과 큰 관계를 보여주지 않는다면, 그래서 기존의 데이터 개수만으로는 충분히 관계를 찾아낼 수 없다면 모델의 성능은 더욱 악화될 것이다.</p><p>또한 좋은 feature라고 할지라도 bias 감소보다 그에 따른 분산의 증가가 더 클수도 있기 때문에 이를 항상 고려해야한다.</p><h5 id="644-interpreting-results-in-high-dimensions">6.4.4 Interpreting Results in High Dimensions</h5><p>high dimensions 에서는 multicollinearity 의 문제도 피할 수 없다.</p><p>변수선택으로 얻은 모델을 과신하지말고 다른 좋은 모델은 없는지 검증해보아야 한다.</p><p>모델 평가 측도로 overfitting에 취약한 SSE(sum of squared error), p-values, R-squared 들을 선택해서는 안된다. test data 에 대한 예측력은 장담할 수 없기 때문.</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/datascience/" class="post-tag no-text-decoration" >datascience</a> <a href="/tags/datamining/" class="post-tag no-text-decoration" >datamining</a> <a href="/tags/machinelearning/" class="post-tag no-text-decoration" >machinelearning</a> <a href="/tags/islr/" class="post-tag no-text-decoration" >ISLR</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ISLR chap 6 - For Statistics&url=https://hwankam.github.io/posts/ISLR6/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ISLR chap 6 - For Statistics&u=https://hwankam.github.io/posts/ISLR6/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=ISLR chap 6 - For Statistics&url=https://hwankam.github.io/posts/ISLR6/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/PRML6/">PRML-6</a><li><a href="/posts/PRML5/">PRML-5</a><li><a href="/posts/PRML4/">PRML-4</a><li><a href="/posts/PRML3/">PRML-3</a><li><a href="/posts/CASI9/">Computer Age Statistical Inference - chap 9</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/datamining/">datamining</a> <a class="post-tag" href="/tags/machinelearning/">machinelearning</a> <a class="post-tag" href="/tags/islr/">ISLR</a> <a class="post-tag" href="/tags/statistical-method/">statistical method</a> <a class="post-tag" href="/tags/efron/">Efron</a> <a class="post-tag" href="/tags/prml/">PRML</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/categorical-data/">categorical data</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ISLR2/"><div class="card-body"> <span class="timeago small" >Jul 29, 2021<i class="unloaded">2021-07-29T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ISLR chap 2</h3><div class="text-muted small"><p> 2.1 What is statistical learning? 2.1.1 X : predictor, features, independent variable Y : response, dependent variable $ Y = f(X) + \epsilon $ $ \hat Y = \hat f(X) $ reducible error : Y를 ...</p></div></div></a></div><div class="card"> <a href="/posts/ISLR2-LAB/"><div class="card-body"> <span class="timeago small" >Jul 30, 2021<i class="unloaded">2021-07-30T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ISLR - LAB2</h3><div class="text-muted small"><p> R 코드 정리 #할당, c는 백터를 의미 x &lt;- c(1,2,3,4) # 백터의 원소 개수 length(x) #저장되어 있는 변수 모두 호출 ls() #remove rm(x) rm(list=ls()) #행렬 x = matrix(data=c(1,2,3,4), nrow=2, ncol=2) x y = matrix(data=c(1,2,3,4), nr...</p></div></div></a></div><div class="card"> <a href="/posts/ISLR3-LAB/"><div class="card-body"> <span class="timeago small" >Jul 30, 2021<i class="unloaded">2021-07-30T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ISLR - LAB3</h3><div class="text-muted small"><p> R 코드 정리 library(MASS) fix(Boston) #table 형태로 보여주기 names(Boston) # 열 이름 보여주기 attach(Boston) lm.fit = lm( medv ~ lstat) summary(lm.fit) """ Call: lm(formula = medv ~ lstat) Residuals: Min ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ISLR5-LAB/" class="btn btn-outline-primary" prompt="Older"><p>ISLR - LAB5</p></a> <a href="/posts/ISLR6-LAB/" class="btn btn-outline-primary" prompt="Newer"><p>ISLR - LAB6</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/datamining/">datamining</a> <a class="post-tag" href="/tags/machinelearning/">machinelearning</a> <a class="post-tag" href="/tags/islr/">ISLR</a> <a class="post-tag" href="/tags/statistical-method/">statistical method</a> <a class="post-tag" href="/tags/efron/">Efron</a> <a class="post-tag" href="/tags/prml/">PRML</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/categorical-data/">categorical data</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}}); </script> MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) { alert("Math Processing Error: "+message[1]); }); MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) { alert("Math Processing Error: "+message[1]); }); </script> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
