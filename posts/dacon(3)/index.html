<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Dacon - 구내식당 식수 인원 예측 AI 경진대회" /><meta property="og:locale" content="en" /><meta name="description" content="대회에서 우수한 성적을 거두신 분들이 본인들의 코드를 상세히 올려주셔서 이를 참고해서 공부를 하고 있습니다. 이번 글에서는 새로운 접근 방식에 대한 아이디어 그리고 내가 사용하지 못했지만 괜찮아 보이는 코딩 방식에 대해 적어보겠습니다." /><meta property="og:description" content="대회에서 우수한 성적을 거두신 분들이 본인들의 코드를 상세히 올려주셔서 이를 참고해서 공부를 하고 있습니다. 이번 글에서는 새로운 접근 방식에 대한 아이디어 그리고 내가 사용하지 못했지만 괜찮아 보이는 코딩 방식에 대해 적어보겠습니다." /><link rel="canonical" href="https://hwankam.github.io/posts/dacon(3)/" /><meta property="og:url" content="https://hwankam.github.io/posts/dacon(3)/" /><meta property="og:site_name" content="For Statistics" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-29T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Dacon - 구내식당 식수 인원 예측 AI 경진대회" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"대회에서 우수한 성적을 거두신 분들이 본인들의 코드를 상세히 올려주셔서 이를 참고해서 공부를 하고 있습니다. 이번 글에서는 새로운 접근 방식에 대한 아이디어 그리고 내가 사용하지 못했지만 괜찮아 보이는 코딩 방식에 대해 적어보겠습니다.","url":"https://hwankam.github.io/posts/dacon(3)/","headline":"Dacon - 구내식당 식수 인원 예측 AI 경진대회","dateModified":"2021-10-17T16:27:20+09:00","datePublished":"2021-07-29T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://hwankam.github.io/posts/dacon(3)/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>Dacon - 구내식당 식수 인원 예측 AI 경진대회 | For Statistics</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="For Statistics"><meta name="application-name" content="For Statistics"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">For Statistics</a></div><div class="site-subtitle font-italic">kam's world</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Hwankam" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Dacon - 구내식당 식수 인원 예측 AI 경진대회</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Dacon - 구내식당 식수 인원 예측 AI 경진대회</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> your_full_name </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Jul 29, 2021, 12:00 AM +0900" >Jul 29, 2021<i class="unloaded">2021-07-29T00:00:00+09:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 17, 2021, 4:27 PM +0900" >Oct 17, 2021<i class="unloaded">2021-10-17T16:27:20+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1009 words">5 min read</span></div></div><div class="post-content"><p>대회에서 우수한 성적을 거두신 분들이 본인들의 코드를 상세히 올려주셔서 이를 참고해서 공부를 하고 있습니다. 이번 글에서는 새로운 접근 방식에 대한 아이디어 그리고 내가 사용하지 못했지만 괜찮아 보이는 코딩 방식에 대해 적어보겠습니다.</p><p>또한 다른 좋은 방식들이 추가로 발견된다면 이 글에 추가로 작성하도록 하겠습니다.</p><h5 id="1-columns-name-한꺼번에-바꾸기튜플-사용">1. columns name 한꺼번에 바꾸기(튜플 사용)</h5><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">trian</span><span class="p">.</span><span class="n">columns</span> <span class="c1"># Index(['일자', '요일'], dtype='object')
</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s">'일자'</span><span class="p">:</span> <span class="s">'time'</span><span class="p">,</span> <span class="s">'요일'</span><span class="p">:</span> <span class="s">'date'</span><span class="p">}</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">train</span><span class="p">.</span><span class="n">columns</span> <span class="c1"># Index(['time', 'date'], dtype='object')
</span></pre></table></code></div></div><h5 id="2--shift를-사용해서-전년도-전월-전일-대비-데이터-feature-만들기">2. shift를 사용해서 전년도/ 전월/ 전일 대비 데이터 feature 만들기</h5><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>  <span class="n">x</span><span class="p">[</span><span class="s">'ratio'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">'A'</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="s">'A'</span><span class="p">].</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s">'A'</span><span class="p">].</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="mf">0.01</span>
</pre></table></code></div></div><p>0.01 이라는 작은수를 더해서 0과 같이 너무 작은 값에 대비하기</p><p>이러한 데이터를 사용해서 예측을 할 때에는 첫번째 행의 경우 전월 대비 데이터가 없기 때문에 첫번째 행 / 나머지 행 이렇게 나누어서 새로 코드를 짜야한다.</p><p>즉</p><p>for i in range(0, 50) :</p><p>​ if i == 0 :</p><p>​ if i != 0 :</p><h5 id="3--pandas-에서-query를-사용해서-특정-조건-추출해내기with-where">3. pandas 에서 query를 사용해서 특정 조건 추출해내기(with where)</h5><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre><td class="rouge-code"><pre><span class="c1">#기존 내 방식
</span><span class="n">mask</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span> <span class="s">'수'</span>
<span class="n">train</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="c1">#query를 사용한 방식
</span><span class="n">mask</span> <span class="o">=</span> <span class="s">"요일 == '수'"</span>
<span class="n">train</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>

<span class="c1">#query는 비교, in, 논리연산자, 외부변수 참조 연산이 모두 가능하다
#외부변수 참조(@ 을 변수 앞에 붙인다)
</span><span class="n">wed</span> <span class="o">=</span> <span class="s">'수'</span>
<span class="n">mask</span> <span class="o">=</span> <span class="s">"요일 = @wed"</span>
<span class="n">train</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>


<span class="c1">## 추가로 where 을 사용해서도 조건을 추출해낼 수 있다.
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">aa</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>

<span class="n">aa</span><span class="p">[</span><span class="n">aa</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># Out[1]: 
</span><span class="mi">3</span>    <span class="mi">3</span>
<span class="mi">4</span>    <span class="mi">4</span>
<span class="mi">5</span>    <span class="mi">5</span>

<span class="n">aa</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">aa</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#Out[2]: 
</span><span class="mi">0</span>    <span class="n">NaN</span>
<span class="mi">1</span>    <span class="n">NaN</span>
<span class="mi">2</span>    <span class="n">NaN</span>
<span class="mi">3</span>    <span class="mf">3.0</span>
<span class="mi">4</span>    <span class="mf">4.0</span>
<span class="mi">5</span>    <span class="mf">5.0</span>

<span class="n">aa</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">aa</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#Out[3]: 
</span><span class="mi">0</span>    <span class="mi">0</span>
<span class="mi">1</span>    <span class="mi">0</span>
<span class="mi">2</span>    <span class="mi">0</span>
<span class="mi">3</span>    <span class="mi">3</span>
<span class="mi">4</span>    <span class="mi">4</span>
<span class="mi">5</span>    <span class="mi">5</span>

<span class="c1">#where 에서 axis를 사용해서 dataframe 변환하기
</span>
<span class="c1">#axis=0 는 처음 인자에 만족하지 않는 행렬 위치들에 대해 두번째 인수인 행 또는 열의 위치 값으로 행 안에서 만족하지 않는 값을 대체해라 
#axis=1 는 처음 인자에 만족하지 않는 행렬 위치들에 대해 두번째 인수인 행 또는 열의 위치 값으로 열 안에서 만족하지 않는 값을 모두 대체해라 
</span><span class="n">aa</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>

<span class="n">aa</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">aa</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">,</span> <span class="n">aa</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#Out[4]: 
</span>   <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>
<span class="mi">0</span>  <span class="mi">2</span>  <span class="mi">2</span>  <span class="mi">2</span>
<span class="mi">1</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>
<span class="mi">2</span>  <span class="mi">7</span>  <span class="mi">8</span>  <span class="mi">9</span>

<span class="n">aa</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">aa</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">,</span> <span class="n">aa</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#Out[5]: 
</span>   <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>
<span class="mi">0</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>
<span class="mi">1</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>
<span class="mi">2</span>  <span class="mi">7</span>  <span class="mi">8</span>  <span class="mi">9</span>
</pre></table></code></div></div><p>나는 본래 특정 변수에 조건들을 할당에서 데이터프레임 뒤에 변수를 붙여주는 식으로 원하는 데이터만 뽑아냈는데 query를 사용하는 방법도 있어서 가지고 왔다.</p><h5 id="4-cross-validation-하는-도중-각각에서-중요한-변수를-찾아낼-수-있다lgbm">4. cross-validation 하는 도중 각각에서 중요한 변수를 찾아낼 수 있다(LGBM)</h5><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">lgb</span> <span class="o">=</span> <span class="n">LGBMRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">lgb</span><span class="p">,</span> <span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'eat_lunch'</span><span class="p">,</span> <span class="s">'eat_dinner'</span><span class="p">,</span> <span class="s">'time'</span><span class="p">,</span> <span class="s">'day'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">train</span><span class="p">[</span><span class="s">'eat_lunch'</span><span class="p">],</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="s">'neg_mean_squared_error'</span><span class="p">,</span> <span class="n">return_estimator</span> <span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">estimator</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s">'estimator'</span><span class="p">]):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Features sorted by their score for estimator {}:"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">feature_importances</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">estimator</span><span class="p">.</span><span class="n">feature_importances_</span><span class="p">,</span>
                                       <span class="n">index</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'eat_lunch'</span><span class="p">,</span> <span class="s">'eat_dinner'</span><span class="p">,</span> <span class="s">'time'</span><span class="p">,</span> <span class="s">'day'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">columns</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'importance'</span><span class="p">]).</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'importance'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">feature_importances</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">((</span><span class="o">-</span><span class="n">output</span><span class="p">[</span><span class="s">'test_score'</span><span class="p">]).</span><span class="n">mean</span><span class="p">()))</span>
</pre></table></code></div></div><h5 id="5-예측력이-떨어질-때에는-특정-구간을-묶어서-분류의-형태로-회귀를-접근할-수-있다">5. 예측력이 떨어질 때에는 특정 구간을 묶어서 분류의 형태로 회귀를 접근할 수 있다</h5><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">1400</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">train</span><span class="p">[</span><span class="s">'중식계_cut'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">cut</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'중식계'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">train</span><span class="p">[</span><span class="s">'석식계_cut'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">cut</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'석식계'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
</pre></table></code></div></div><p>이는 어떤 논문에서 얻어낸 아이디어이다. 기회가 되면 구현해보도록 하겠다.</p><ul><li>이글은 데이콘 ‘레이’님의 코드 공유 글을 참조했습니다.</ul></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/datascience/" class="post-tag no-text-decoration" >datascience</a> <a href="/tags/dacon/" class="post-tag no-text-decoration" >dacon</a> <a href="/tags/machine-learning/" class="post-tag no-text-decoration" >machine learning</a> <a href="/tags/pandas/" class="post-tag no-text-decoration" >pandas</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Dacon - 구내식당 식수 인원 예측 AI 경진대회 - For Statistics&url=https://hwankam.github.io/posts/dacon(3)/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Dacon - 구내식당 식수 인원 예측 AI 경진대회 - For Statistics&u=https://hwankam.github.io/posts/dacon(3)/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Dacon - 구내식당 식수 인원 예측 AI 경진대회 - For Statistics&url=https://hwankam.github.io/posts/dacon(3)/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/PRML6/">PRML-6</a><li><a href="/posts/PRML5/">PRML-5</a><li><a href="/posts/PRML4/">PRML-4</a><li><a href="/posts/PRML3/">PRML-3</a><li><a href="/posts/CASI9/">Computer Age Statistical Inference - chap 9</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/datamining/">datamining</a> <a class="post-tag" href="/tags/machinelearning/">machinelearning</a> <a class="post-tag" href="/tags/islr/">ISLR</a> <a class="post-tag" href="/tags/statistical-method/">statistical method</a> <a class="post-tag" href="/tags/efron/">Efron</a> <a class="post-tag" href="/tags/prml/">PRML</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/categorical-data/">categorical data</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/dacon(1)/"><div class="card-body"> <span class="timeago small" >Jul 28, 2021<i class="unloaded">2021-07-28T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Dacon - 구내식당 식수 인원 예측 AI 경진대회</h3><div class="text-muted small"><p> 처음으로 참여했던 데이콘 대회에서 프로젝트 과정 중에 느끼고 배웠던 내용들을 정리해보고자 합니다. 이 글은 그에 대한 첫 번째 글로써, 프로젝트에 대한 개괄적 설명과 프로젝트를 진행하면서 고민했던 점을 글로 남겨보도록 하겠습니다. 파이썬을 사용해서 프로젝트를 진행했기 때문에 다소 미흡한 부분이 있습니다. 앞으로 파이썬 실력을 키우기 위해 더욱 노...</p></div></div></a></div><div class="card"> <a href="/posts/dacon(2)/"><div class="card-body"> <span class="timeago small" >Jul 28, 2021<i class="unloaded">2021-07-28T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Dacon - 구내식당 식수 인원 예측 AI 경진대회</h3><div class="text-muted small"><p> 이번 글에서는 더 좋은 성능을 낸 참여자의 모델을 가지고와서 제가 전처리한 데이터에 적합시켜 보도록 하겠습니다. 우선 첫 번째 모델로 pycaret 패키지를 활용한 AutoML 을 구현해보도록 하겠습니다. 결과적으로 이 모델의 성능은 그리 좋지 않았습니다. 실제로 이 모델을 사용한 참가자와는 전처리 방식도 다르고 몇가지 feature 또한 다르기 ...</p></div></div></a></div><div class="card"> <a href="/posts/ensemble/"><div class="card-body"> <span class="timeago small" >Jul 29, 2021<i class="unloaded">2021-07-29T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Ensemble(Bagging, Boosting, Stacking, Blending)</h3><div class="text-muted small"><p> 1. Bagging Bagging은 bootstrap aggregating을 줄인 말이다. overfitting을 방지하기 위한 앙상블 알고리즘의 하나로 분류와 회귀 모두에 사용된다. 앞선 글에서 boostrap을 상세히 설명했는데, boostrapping을 잘 알고 있다고 매우 쉬운 앙상블 알고리즘이라 할 수 있다. Boostraping은 주로 d...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/bootstrap/" class="btn btn-outline-primary" prompt="Older"><p>Boostrap</p></a> <a href="/posts/ensemble/" class="btn btn-outline-primary" prompt="Newer"><p>Ensemble(Bagging, Boosting, Stacking, Blending)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/datamining/">datamining</a> <a class="post-tag" href="/tags/machinelearning/">machinelearning</a> <a class="post-tag" href="/tags/islr/">ISLR</a> <a class="post-tag" href="/tags/statistical-method/">statistical method</a> <a class="post-tag" href="/tags/efron/">Efron</a> <a class="post-tag" href="/tags/prml/">PRML</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/categorical-data/">categorical data</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
