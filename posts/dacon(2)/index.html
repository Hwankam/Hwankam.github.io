<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Dacon - 구내식당 식수 인원 예측 AI 경진대회" /><meta property="og:locale" content="en" /><meta name="description" content="이번 글에서는 더 좋은 성능을 낸 참여자의 모델을 가지고와서 제가 전처리한 데이터에 적합시켜 보도록 하겠습니다." /><meta property="og:description" content="이번 글에서는 더 좋은 성능을 낸 참여자의 모델을 가지고와서 제가 전처리한 데이터에 적합시켜 보도록 하겠습니다." /><link rel="canonical" href="https://hwankam.github.io/posts/dacon(2)/" /><meta property="og:url" content="https://hwankam.github.io/posts/dacon(2)/" /><meta property="og:site_name" content="For Statistics" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-28T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Dacon - 구내식당 식수 인원 예측 AI 경진대회" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"이번 글에서는 더 좋은 성능을 낸 참여자의 모델을 가지고와서 제가 전처리한 데이터에 적합시켜 보도록 하겠습니다.","url":"https://hwankam.github.io/posts/dacon(2)/","headline":"Dacon - 구내식당 식수 인원 예측 AI 경진대회","dateModified":"2021-10-17T16:27:20+09:00","datePublished":"2021-07-28T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://hwankam.github.io/posts/dacon(2)/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>Dacon - 구내식당 식수 인원 예측 AI 경진대회 | For Statistics</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="For Statistics"><meta name="application-name" content="For Statistics"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">For Statistics</a></div><div class="site-subtitle font-italic">kam's world</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Hwankam" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Dacon - 구내식당 식수 인원 예측 AI 경진대회</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Dacon - 구내식당 식수 인원 예측 AI 경진대회</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> your_full_name </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Jul 28, 2021, 12:00 AM +0900" >Jul 28, 2021<i class="unloaded">2021-07-28T00:00:00+09:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 17, 2021, 4:27 PM +0900" >Oct 17, 2021<i class="unloaded">2021-10-17T16:27:20+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2591 words">14 min read</span></div></div><div class="post-content"><p>이번 글에서는 더 좋은 성능을 낸 참여자의 모델을 가지고와서 제가 전처리한 데이터에 적합시켜 보도록 하겠습니다.</p><p>우선 첫 번째 모델로 pycaret 패키지를 활용한 AutoML 을 구현해보도록 하겠습니다.</p><p>결과적으로 이 모델의 성능은 그리 좋지 않았습니다. 실제로 이 모델을 사용한 참가자와는 전처리 방식도 다르고 몇가지 feature 또한 다르기 때문일 것이라 생각합니다. 그럼에도 불구하고 pycaret 패키지는 최초 모델 탐색시에 매우 유용한 기능을 할 것이라 생각이 듭니다.</p><p>제 노트북으로는 pycaret을 돌리는데에는 한계가 있어…. 구글 colab을 활용해서 결과를 도출해냈습니다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="c1">#!pip install pycaret[full]  #모든 모델들을 불러오기 위해 full을 추가합니다
</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">pycaret.regression</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">#코랩에 데이터셋 가져오기 위해 mount 하기
</span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="p">.</span><span class="n">mount</span><span class="p">(</span><span class="s">'/content/drive'</span><span class="p">)</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"/content/drive/MyDrive/train.csv"</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"/content/drive/MyDrive/test.csv"</span><span class="p">)</span>


<span class="c1">#datetime으로 변환
</span><span class="n">train</span><span class="p">[</span><span class="s">'일자'</span><span class="p">]</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'일자'</span><span class="p">])</span>
<span class="n">test</span><span class="p">[</span><span class="s">'일자'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s">'일자'</span><span class="p">])</span>


<span class="c1">#train
</span><span class="n">train</span><span class="p">[</span><span class="s">'년'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'일자'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">year</span>
<span class="n">train</span><span class="p">[</span><span class="s">'월'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'일자'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">month</span>
<span class="n">train</span><span class="p">[</span><span class="s">'일'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'일자'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">day</span>
<span class="n">train</span><span class="p">[</span><span class="s">'주'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'일자'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">week</span>
<span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'일자'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">weekday</span>
<span class="n">train</span><span class="p">[</span><span class="s">'출근'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'본사정원수'</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'본사휴가자수'</span><span class="p">]</span><span class="o">+</span><span class="n">train</span><span class="p">[</span><span class="s">'본사출장자수'</span><span class="p">]</span><span class="o">+</span><span class="n">train</span><span class="p">[</span><span class="s">'현본사소속재택근무자수'</span><span class="p">])</span>
<span class="n">train</span><span class="p">[</span><span class="s">'휴가비율'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'본사휴가자수'</span><span class="p">]</span><span class="o">/</span><span class="n">train</span><span class="p">[</span><span class="s">'본사정원수'</span><span class="p">]</span>
<span class="n">train</span><span class="p">[</span><span class="s">'출장비율'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'본사출장자수'</span><span class="p">]</span><span class="o">/</span><span class="n">train</span><span class="p">[</span><span class="s">'본사정원수'</span><span class="p">]</span>
<span class="n">train</span><span class="p">[</span><span class="s">'야근비율'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'본사시간외근무명령서승인건수'</span><span class="p">]</span><span class="o">/</span><span class="n">train</span><span class="p">[</span><span class="s">'출근'</span><span class="p">]</span>
<span class="n">train</span><span class="p">[</span><span class="s">'재택비율'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'현본사소속재택근무자수'</span><span class="p">]</span><span class="o">/</span><span class="n">train</span><span class="p">[</span><span class="s">'본사정원수'</span><span class="p">]</span>
<span class="n">train</span><span class="p">[</span><span class="s">'출장휴가재택비율'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'출장비율'</span><span class="p">]</span> <span class="o">+</span> <span class="n">train</span><span class="p">[</span><span class="s">'휴가비율'</span><span class="p">]</span> <span class="o">+</span> <span class="n">train</span><span class="p">[</span><span class="s">'재택비율'</span><span class="p">]</span>

<span class="c1">#test
</span><span class="n">test</span><span class="p">[</span><span class="s">'년'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'일자'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">year</span>
<span class="n">test</span><span class="p">[</span><span class="s">'월'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'일자'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">month</span>
<span class="n">test</span><span class="p">[</span><span class="s">'일'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'일자'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">day</span>
<span class="n">test</span><span class="p">[</span><span class="s">'주'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'일자'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">week</span>
<span class="n">test</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'일자'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">weekday</span>
<span class="n">test</span><span class="p">[</span><span class="s">'출근'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'본사정원수'</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s">'본사휴가자수'</span><span class="p">]</span><span class="o">+</span><span class="n">test</span><span class="p">[</span><span class="s">'본사출장자수'</span><span class="p">]</span><span class="o">+</span><span class="n">test</span><span class="p">[</span><span class="s">'현본사소속재택근무자수'</span><span class="p">])</span>
<span class="n">test</span><span class="p">[</span><span class="s">'휴가비율'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'본사휴가자수'</span><span class="p">]</span><span class="o">/</span><span class="n">test</span><span class="p">[</span><span class="s">'본사정원수'</span><span class="p">]</span>
<span class="n">test</span><span class="p">[</span><span class="s">'출장비율'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'본사출장자수'</span><span class="p">]</span><span class="o">/</span><span class="n">test</span><span class="p">[</span><span class="s">'본사정원수'</span><span class="p">]</span>
<span class="n">test</span><span class="p">[</span><span class="s">'야근비율'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'본사시간외근무명령서승인건수'</span><span class="p">]</span><span class="o">/</span><span class="n">test</span><span class="p">[</span><span class="s">'출근'</span><span class="p">]</span>
<span class="n">test</span><span class="p">[</span><span class="s">'재택비율'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'현본사소속재택근무자수'</span><span class="p">]</span><span class="o">/</span><span class="n">test</span><span class="p">[</span><span class="s">'본사정원수'</span><span class="p">]</span>
<span class="n">test</span><span class="p">[</span><span class="s">'출장휴가재택비율'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'출장비율'</span><span class="p">]</span> <span class="o">+</span> <span class="n">test</span><span class="p">[</span><span class="s">'휴가비율'</span><span class="p">]</span> <span class="o">+</span> <span class="n">test</span><span class="p">[</span><span class="s">'재택비율'</span><span class="p">]</span>
</pre></table></code></div></div><p>식수인원수와 관계가 큰 야근 신청 인원수 데이터의 이상치를 제거한다(이에 관한 것은 추후 업로드 할 것임)</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
</pre><td class="rouge-code"><pre>
<span class="c1">#이상치 제거
</span>
<span class="c1">#IQR을 사용해서 이상치 제거하기
#sns.boxplot(x='요일', y = '본사시간외근무명령서승인건수', data=train)
</span>
<span class="c1">#월
</span><span class="n">iqr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span> <span class="o">+</span> <span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">-</span> <span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">mask_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span> <span class="o">&lt;</span> <span class="n">lower</span><span class="p">)</span>
<span class="n">mask_time2</span> <span class="o">=</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'중식계'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'중식계'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">lower</span><span class="p">)</span>
<span class="n">train_outliers</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="n">mask_time</span><span class="p">]</span>
<span class="n">List</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">train_outliers</span><span class="p">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">List</span> <span class="c1">#705 실제 train 데이터에서 엑셀 기준 707
</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">List</span> <span class="p">:</span>
    <span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
<span class="c1">#화 (실제로 예측해야할 데이터들이 화요일에 야근이 많다 따라서 크다고 여겨지는 이상치는 이상치가 아니다)
</span><span class="n">iqr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span> <span class="o">+</span> <span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">-</span> <span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">mask_time</span> <span class="o">=</span>  <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span> <span class="o">&lt;</span> <span class="n">lower</span><span class="p">)</span>
<span class="n">mask_time2</span> <span class="o">=</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'중식계'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'중식계'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">lower</span><span class="p">)</span>
<span class="n">train_outliers</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="n">mask_time</span><span class="p">]</span>
<span class="n">List</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">train_outliers</span><span class="p">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">List</span> <span class="c1">#152, 163, 223, 453*, 467, 951, 955, 1165*, 1170*, 1175* *별표는 큰 이상치
</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">List</span> <span class="p">:</span>
    <span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    

<span class="c1">#수
</span><span class="n">iqr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span> <span class="o">+</span> <span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">-</span> <span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">mask_time</span> <span class="o">=</span>  <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">)</span> <span class="o">|</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span> <span class="o">&lt;</span> <span class="n">lower</span><span class="p">)</span>
<span class="n">mask_time2</span> <span class="o">=</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'중식계'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'중식계'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">lower</span><span class="p">)</span>
<span class="n">train_outliers</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">][</span><span class="n">mask_time</span><span class="p">]</span>
<span class="n">List</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">train_outliers</span><span class="p">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">List</span> <span class="c1">#세자리, 네자리 수인 2,9,14,18 만 지우겠다. 
</span>
<span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">652</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">894</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


<span class="c1">#목
</span><span class="n">iqr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span> <span class="o">+</span> <span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">-</span> <span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">mask_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span> <span class="o">&lt;</span> <span class="n">lower</span><span class="p">)</span>
<span class="n">mask_time2</span> <span class="o">=</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'중식계'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'중식계'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">lower</span><span class="p">)</span>
<span class="n">train_outliers</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">][</span><span class="n">mask_time</span><span class="p">]</span>
<span class="n">List</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">train_outliers</span><span class="p">.</span><span class="n">index</span><span class="p">)</span> <span class="c1">#TESTSET에 746 정도가 있기 때문에 매우 작은 것과 800 이상의 점 두개를 지운다.
</span><span class="n">List</span> 

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">List</span> <span class="p">:</span>
    <span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">mask_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">)</span>
<span class="n">train_outliers</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">][</span><span class="n">mask_time</span><span class="p">]</span>
<span class="n">List</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">train_outliers</span><span class="p">.</span><span class="n">index</span><span class="p">)</span> <span class="c1">#TESTSET에 746 정도가 있기 때문에 매우 작은 것과 800 이상의 점 두개를 지운다.
</span><span class="n">List</span>  <span class="c1">#415, 1137
</span>
<span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">415</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">1137</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


<span class="c1">#금
</span><span class="n">iqr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span> <span class="o">+</span> <span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">-</span> <span class="n">iqr</span><span class="o">*</span><span class="mf">1.5</span>
<span class="n">mask_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">].</span><span class="n">본사시간외근무명령서승인건수</span> <span class="o">&lt;</span> <span class="n">lower</span><span class="p">)</span>
<span class="n">mask_time2</span> <span class="o">=</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'중식계'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'중식계'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">lower</span><span class="p">)</span>
<span class="n">train_outliers</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">][</span><span class="n">mask_time</span><span class="p">]</span>
<span class="n">List</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">train_outliers</span><span class="p">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">List</span>  <span class="c1"># 400이상인 895번 index만 삭제한다.
</span>
<span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">895</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


<span class="c1">#train에서 결측치 이상치 제거하기
</span>
<span class="n">mask_oo</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'일자'</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'2017-09-27'</span> 
<span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">mask_oo</span><span class="p">]</span>
<span class="n">mask_ooo</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'일자'</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'2018-02-14'</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">mask_ooo</span><span class="p">]</span>
<span class="n">train</span>


<span class="n">mask_0</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'석식계'</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">mask_0</span><span class="p">]</span>
<span class="n">train</span>


</pre></table></code></div></div><p>점심 데이터 적합</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">caret</span> <span class="o">=</span> <span class="n">setup</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">train_lunch</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="s">'중식계'</span><span class="p">,</span> <span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s">'월'</span><span class="p">,</span><span class="s">'요일'</span><span class="p">])</span> <span class="c1">#실행시키고 엔터 한번 더 눌러줘야한다.
</span>
<span class="n">best_lunch</span> <span class="o">=</span> <span class="n">compare_models</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="s">'MAE'</span><span class="p">,</span> <span class="n">n_select</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">blend_lunch</span> <span class="o">=</span> <span class="n">blend_models</span><span class="p">(</span><span class="n">estimator_list</span><span class="o">=</span> <span class="n">best_lunch</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="s">'MAE'</span><span class="p">)</span>
<span class="n">pred_holdout</span> <span class="o">=</span> <span class="n">predict_model</span><span class="p">(</span><span class="n">blend_lunch</span><span class="p">)</span><span class="c1">#블랜딩
</span>
<span class="n">final_model</span> <span class="o">=</span> <span class="n">finalize_model</span><span class="p">(</span><span class="n">blend_lunch</span><span class="p">)</span>
<span class="n">predictions_lunch</span> <span class="o">=</span> <span class="n">predict_model</span><span class="p">(</span><span class="n">final_model</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">test2</span><span class="p">)</span>
<span class="n">aa</span> <span class="o">=</span> <span class="n">predictions_lunch</span><span class="p">[</span><span class="s">'Label'</span><span class="p">]</span>
</pre></table></code></div></div><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="./assets/img/lunch_pycaret.png" width="70%" height="70%" title="lunch" /> <img data-proofer-ignore data-src="./assets/img/lunch_pycaret.png" alt="lunch" /></p><p>저녁 데이터 또한 위와 마찬가지로 적합하면 다음과 같은 결과를 얻을 수 있다</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/dinner_pycaret.png" width="70%" height="70%" title="dinner" /></p><p>즉 피처 엔지니어링 이후 모델 적합할 때 성능이 좋은 모델 몇개를 빠르게 추려낼 수 있다는 장점이 있는 것 같다. 내가 최종적으로 제출한 모델 또한 catboost를 활용했는데 여기서도 MAE를 기준으로 제일 성능이 좋음을 알 수 있다.</p><p>pycaret에 대해 추가적인 설명을 덧붙이자면 다음과 같다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">setup</span><span class="p">()</span> <span class="p">:</span> <span class="n">주어진</span> <span class="n">데이터를</span> <span class="n">모델</span> <span class="n">별로</span> <span class="n">적합시킬</span> <span class="n">준비를</span> <span class="n">마친다</span>

<span class="n">compare_models</span><span class="p">()</span> <span class="p">:</span> <span class="n">모델별</span> <span class="n">비교를</span> <span class="n">한다</span><span class="p">.</span> <span class="n">sort를</span> <span class="n">통해</span> <span class="n">우선적으로</span> <span class="n">보고</span> <span class="n">싶은</span> <span class="n">평가</span> <span class="n">척도를</span> <span class="n">제시한다</span><span class="p">.</span> <span class="n">또한</span> <span class="n">n_select를</span> <span class="n">통해</span> <span class="n">선택할</span> <span class="n">모델의</span> <span class="n">개수를</span> <span class="n">설정할</span> <span class="n">수</span> <span class="n">있다</span><span class="p">.</span>

<span class="n">blend_models</span><span class="p">()</span> <span class="p">:</span> <span class="n">앙상블의</span> <span class="n">일종으로</span> <span class="n">블랜딩</span> <span class="n">앙상블을</span> <span class="n">실행한다</span><span class="p">.</span>
    
<span class="n">stack_models</span><span class="p">()</span> <span class="p">:</span> <span class="n">앙상블의</span> <span class="n">일종으로</span> <span class="n">스태킹</span> <span class="n">앙상블을</span> <span class="n">실행한다</span><span class="p">.</span>

<span class="n">ensemble_models</span><span class="p">()</span> <span class="p">:</span> <span class="n">앙상블</span> <span class="n">중</span> <span class="n">배깅을</span> <span class="n">통해</span> <span class="n">모델을</span> <span class="n">만들어</span> <span class="n">낸다</span><span class="p">.</span> <span class="n">method</span> <span class="o">=</span> <span class="s">'boosting'</span> <span class="n">을</span> <span class="n">통해서</span> <span class="n">부스팅을</span> <span class="n">통한</span> <span class="n">앙상블</span> <span class="n">모형을</span> <span class="n">만들</span> <span class="n">수</span> <span class="n">있다</span><span class="p">.</span>
    
<span class="n">creat_models</span><span class="p">()</span> <span class="p">:</span> <span class="n">compare_models</span><span class="p">()</span> <span class="n">의</span> <span class="n">결과를</span> <span class="n">통해</span> <span class="n">얻은</span> <span class="n">모델</span> <span class="n">중</span> <span class="n">일부를</span> <span class="n">선택해서</span> <span class="n">모델을</span> <span class="n">만든다</span><span class="p">.</span>
</pre></table></code></div></div><p>※추가로 7월 29일자로 새로운 분이 pycaret을 통해 private 10위를 하신 것을 확인했다. 이 분은 블랜딩과정에서 5개를 가져왔는데 이를 통해 overfitting 방지를 잘 하신 것 같다. 특히 이번 대회에서 test set의 특성이 train set과 다를것이라는 예상을 했다면 더 많은 모델을 블랜딩함으로써 모델의 일반성을 유지할 수 있었을 것 같다.</p><p>*이 글은 데이콘 ‘찰진식수인원’ 님과 ‘학식의신’님의 코드 공유 글을 참고했습니다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/datascience/" class="post-tag no-text-decoration" >datascience</a> <a href="/tags/dacon/" class="post-tag no-text-decoration" >dacon</a> <a href="/tags/machine-learning/" class="post-tag no-text-decoration" >machine learning</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Dacon - 구내식당 식수 인원 예측 AI 경진대회 - For Statistics&url=https://hwankam.github.io/posts/dacon(2)/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Dacon - 구내식당 식수 인원 예측 AI 경진대회 - For Statistics&u=https://hwankam.github.io/posts/dacon(2)/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Dacon - 구내식당 식수 인원 예측 AI 경진대회 - For Statistics&url=https://hwankam.github.io/posts/dacon(2)/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/PRML6/">PRML-6</a><li><a href="/posts/PRML5/">PRML-5</a><li><a href="/posts/PRML4/">PRML-4</a><li><a href="/posts/PRML3/">PRML-3</a><li><a href="/posts/CASI9/">Computer Age Statistical Inference - chap 9</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/datamining/">datamining</a> <a class="post-tag" href="/tags/machinelearning/">machinelearning</a> <a class="post-tag" href="/tags/islr/">ISLR</a> <a class="post-tag" href="/tags/statistical-method/">statistical method</a> <a class="post-tag" href="/tags/efron/">Efron</a> <a class="post-tag" href="/tags/prml/">PRML</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/categorical-data/">categorical data</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/dacon(1)/"><div class="card-body"> <span class="timeago small" >Jul 28, 2021<i class="unloaded">2021-07-28T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Dacon - 구내식당 식수 인원 예측 AI 경진대회</h3><div class="text-muted small"><p> 처음으로 참여했던 데이콘 대회에서 프로젝트 과정 중에 느끼고 배웠던 내용들을 정리해보고자 합니다. 이 글은 그에 대한 첫 번째 글로써, 프로젝트에 대한 개괄적 설명과 프로젝트를 진행하면서 고민했던 점을 글로 남겨보도록 하겠습니다. 파이썬을 사용해서 프로젝트를 진행했기 때문에 다소 미흡한 부분이 있습니다. 앞으로 파이썬 실력을 키우기 위해 더욱 노...</p></div></div></a></div><div class="card"> <a href="/posts/dacon(3)/"><div class="card-body"> <span class="timeago small" >Jul 29, 2021<i class="unloaded">2021-07-29T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Dacon - 구내식당 식수 인원 예측 AI 경진대회</h3><div class="text-muted small"><p> 대회에서 우수한 성적을 거두신 분들이 본인들의 코드를 상세히 올려주셔서 이를 참고해서 공부를 하고 있습니다. 이번 글에서는 새로운 접근 방식에 대한 아이디어 그리고 내가 사용하지 못했지만 괜찮아 보이는 코딩 방식에 대해 적어보겠습니다. 또한 다른 좋은 방식들이 추가로 발견된다면 이 글에 추가로 작성하도록 하겠습니다. 1. columns name 한...</p></div></div></a></div><div class="card"> <a href="/posts/ensemble/"><div class="card-body"> <span class="timeago small" >Jul 29, 2021<i class="unloaded">2021-07-29T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Ensemble(Bagging, Boosting, Stacking, Blending)</h3><div class="text-muted small"><p> 1. Bagging Bagging은 bootstrap aggregating을 줄인 말이다. overfitting을 방지하기 위한 앙상블 알고리즘의 하나로 분류와 회귀 모두에 사용된다. 앞선 글에서 boostrap을 상세히 설명했는데, boostrapping을 잘 알고 있다고 매우 쉬운 앙상블 알고리즘이라 할 수 있다. Boostraping은 주로 d...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/dacon(1)/" class="btn btn-outline-primary" prompt="Older"><p>Dacon - 구내식당 식수 인원 예측 AI 경진대회</p></a> <a href="/posts/bootstrap/" class="btn btn-outline-primary" prompt="Newer"><p>Boostrap</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/datamining/">datamining</a> <a class="post-tag" href="/tags/machinelearning/">machinelearning</a> <a class="post-tag" href="/tags/islr/">ISLR</a> <a class="post-tag" href="/tags/statistical-method/">statistical method</a> <a class="post-tag" href="/tags/efron/">Efron</a> <a class="post-tag" href="/tags/prml/">PRML</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/categorical-data/">categorical data</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
