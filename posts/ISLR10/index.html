<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="ISLR chap 10" /><meta property="og:locale" content="en" /><meta name="description" content="10. Unsupervised Learning" /><meta property="og:description" content="10. Unsupervised Learning" /><link rel="canonical" href="https://hwankam.github.io/posts/ISLR10/" /><meta property="og:url" content="https://hwankam.github.io/posts/ISLR10/" /><meta property="og:site_name" content="For Statistics" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-10T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ISLR chap 10" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"10. Unsupervised Learning","url":"https://hwankam.github.io/posts/ISLR10/","headline":"ISLR chap 10","dateModified":"2021-10-17T16:22:10+09:00","datePublished":"2021-08-10T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://hwankam.github.io/posts/ISLR10/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>ISLR chap 10 | For Statistics</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="For Statistics"><meta name="application-name" content="For Statistics"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">For Statistics</a></div><div class="site-subtitle font-italic">kam's world</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Hwankam" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>ISLR chap 10</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>ISLR chap 10</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> your_full_name </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Aug 10, 2021, 12:00 AM +0900" >Aug 10, 2021<i class="unloaded">2021-08-10T00:00:00+09:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 17, 2021, 4:22 PM +0900" >Oct 17, 2021<i class="unloaded">2021-10-17T16:22:10+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3779 words">20 min read</span></div></div><div class="post-content"><h3 id="10-unsupervised-learning">10. Unsupervised Learning</h3><p>supervised learning : X를 가지고 Y를 예측하는 것</p><p>unsupervised learning : X 데이터만을 가지고 어떠한 특성을 밝히는 것. visualize… subgroups…</p><p>대표적인 비지도학습 : PCA : visualization, pre-processing / clustering : subgroup</p><h4 id="101-the-challenge-of-unsupervised-learning">10.1 The Challenge of Unsupervised Learning</h4><p>앞서 지도학습에서는 분류 혹은 회귀 라는 분석 목적이 뚜렷했으며, 지도학습 분석의 성능에 대해 평가하는 기준이 명확했다(e.g CV).</p><p>그러나 비 지도학습의 경우에는 분석의 목적이 다소 주관적이며 exploratory data analysis(EDA) 의 성격을 가지고 있다. 또한 분석의 결과가 얼마나 신뢰할 수 있고 바람직한지를 평가하는 기준이 없다.(Y 관측치가 존재하지 않는다!!)</p><p>그럼에도 불구하고 비지도학습의 중요성은 점점 커져간다. 이는 데이터 자제의 숨겨진 속성들을 추출해냄으로서 더 많은 부가가치를 창출할 수 있기 때문이다.</p><h4 id="102-principal-components-analysis">10.2 Principal Components Analysis</h4><p>ISLR 6.3.1 부분의 PCR 을 참고하자</p><h5 id="1021-what-are-principal-components">10.2.1 What Are Principal Components</h5><p>feature의 개수가 많다면, 정보의 관계를 한눈에 파악하기 힘들다. 대신 이러한 정보들을 추출해서 2차원 데이터로 만들어 시각화 한다면 훨씬 이해하기 편하다. ==&gt; PCA</p><p>pca는 관심 정보들을 작은 차원에서 설명하려는 노력. 축소된 차원은 본래의 p 개의 feature들에 대한 조합</p><p>first PC of normalized data 는 다음과 같이 조합된다.</p>\[Z_1 = \phi _{11}X_1 + \phi_{21}X_2 + ... + \phi_{p1}X_p\]<p>여기서 phi 값은 방향을 의미하고 Z_1이 first PC라면 phi는 가장 분산이 큰 방향을 의미하게 될 것. 그리고 Z 값은 score 값으로 phi에 의해 정해진 방향에 X를 사영시켰을 때 나오는 projected value이다.</p><p>(pc loading phi 의 제곱합은 1 : 이런 제약 조건이 없다면 분산을 가장 크게 만든다는 데이터의 조합에 대한 기준이 없어짐.)</p><p>pc loading 을 찾는 공식은 아래와 같다</p>\[max_{\phi_{11},..., \phi_{p1}} \frac {1}{n} \{\ \sum_i^n(\sum_j^p \phi_{j1}x_{ij})^2\} \ \ subject \ \ to \ \ \sum \phi^2_{j1} = 1\]<p>위 공식을 처음보면 어떻게 나온 것인지 헷갈릴 수 있다. i는 obs, j 는 feature를 의미하며, 데이터가 표준화되어있다는 전제하에 $ \sum <em>i x</em>{ij} = 0 $ 이므로 maximization 하고자 하는 값은 결국 분산을 의미한다. 또한 이렇게 분산을 극대화시키는 pc score를 찾는 것은 결국 데이터의 eigen-value 값을 찾는 것과 동일한데 이 내용은 책에 생략되어있다.</p><p>두 번째 PC score Z_2 를 찾기 위해서는 분산이 Z_1 다음으로 크게 하면서도 Z_1과는 uncorrelated 되어있는 X들의 linear combination을 찾아야 한다. 이는 loading벡터의 방향이 이전 first PC score의 loading 벡터와 직교하도록 만들면 된다. 즉 PC loading 을 찾기위해 제약조건하에서의 최적화 식에서 추가적으로 직교성을 추가하면 된다.</p><p>기하학적으로 생각해보자. 주성분을 계산하고 나면 낮은 차원에서 이를 plot 할 수 있는데, PC score 벡터는 본래 데이터(X)를 방향벡터인 phi로 span 된 공간에 사영시킨 것을 의미한다.</p><p>방향벡터 \(\phi\) 들은 \(X'X\) 의 eigenvector가 되고(X’X는 표준화된 X에 대한 분산행렬이다) PC score의 분산값은 eigen value가 된다</p><p>기하학적 내용에 대해 수식으로 접근해보면</p><p>단위벡터 e에 의해 span 된 공간에 X 데이터를 사영하는 것은 \(Xe\) 이고 이것의 분산이 최대가 되도록 사영하는 것을 목적으로 하기 때문에 \(Max_e \ \ [Var(Xe)] \ \ subject \ \ to \ \ \sum e_i^2 = 1\) 를 풀면 \(\Sigma e = \lambda e\) 를 만족할 때 위 식을 최대로 만들 수 있다. 여기서 lambda는 고유값이고 e는 고유 벡터가 된다. 즉 데이터의 분산을 최대로 하는 방향벡터는 X의 분산에 대한 고유벡터이고, PC score의 값은 고유값 lambda가 된다</p>\[Var(\Sigma e) = e'\Sigma e \ = e' \lambda\ e = \lambda\]<p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr10-1.png" width="70%" height="70%" title="1" alt="relative" /></p><p>PCA는 요인분석과도 연관이 깊은데 이에 대한 내용이 살짝 언급되어 있다.</p><p>아래 표를 보자</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr10-2.png" width="70%" height="70%" title="1" alt="relative" /></p><p>pc1의 loading vector를 보면 Murder, Assault, Rape 의 비율이 높다. 즉 pc1은 중범죄율이라는 새로운 변수로 해석할 수 있다. 반대로 pc2를 보면 UrbanPop의 비율이 높다. 즉 pc2는 도시화율이라는 변수로 해석될 수 있다. 즉 pc1의 score 값이 높은 obs의 경우 높은 범죄율을 가지는 데이터라 말할 수 있다. 만약 어떤 obs가 각 score의 값이 0 인 경우는 범죄율이나 도시화에 대해서 그냥 평균정도의 상황임을 드러내는 것이라 할 수 있다.</p><h5 id="1022-another-interpretation-of-principal-components">10.2.2 Another Interpretation of Principal Components</h5><p>Principal component의 또 다른 해석은 바로 관측치와 가장 가까운 low dimensional linear surface를 제공한다는 것이다. first pc loading vector는 p 차원의 데이터에서 이들과 가장 가까운 line을 의미한다. 여기서 더 나아가 first two pc loading vector는 데이터와 가장 거리가 가까운 평면을 만들어 낸다.</p><p>즉 차원이 매우 클 때, M개의 pc score 값 혹은 pc loading vector 들이 원 데이터를 잘 설명하는 근사치가 될 수 있다.</p>\[x_{ij} \approx \sum ^M z_{im}\phi_{jm}\]<p>또한, $ M = min(n-1,p) $ 이면 정확히</p>\[x_{ij} = \sum ^M z_{im}\phi_{jm}\]<p>가 성립한다.</p><h5 id="1023-more-on-pca">10.2.3 More on PCA</h5><p>(1) 분산을 기준으로 데이터를 축소하기 때문에 측정 단위가 동일해야 한다. =&gt; 표준화가 꼭 필요하다.</p><p>(2) prinicpal component loading vector는 유일하다. 즉 단위가 바뀌거나 flip되어도 벡터는 동일하다. 또한 score vector 또한 유일하다. 이는 z에 대한 분산이나, -z 에 대한 분산이 동일한 것과 같은 이치이다.</p><p>(3) Principal component 중 몇개를 뽑는 것으로 전체 데이터를 축약한다면 데이터의 소실량은 얼마인가? 분산의 비로 나타내보자.</p><p>==&gt; proportion of variance explained(PVE) of the m-th principal component</p>\[\frac {\sum^n(\sum^p \phi_{jm} x_{ij})^2}{\sum^p(\sum^n x_{ij^2})}\]<p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr10-3.png" width="70%" height="70%" title="1" alt="relative" /></p><p>(4) 그럼 principal component를 몇개 골라야 할까?</p><p>전체데이터를 잘 설명하는 축소된 변수가 작으면 작을수록 좋을 것이다.</p><p>scree plot을 가지고 볼 때 분산 비율이 크게 감소하지 않는 지점 직전까지로 principal component의 개수를 정하면 좋을 것이다. 그러나 이는 각 데이터마다 어떻게 할지 모두 다르므로, 각 principal components 마다 어떠 패턴이 존재하는지 확인해보면 좋을 것이다. 만약 PC regression(지도학습) 을 하는 경우라면 CV 값이 제일 작은 principal component개수를 설정하면 될 것이다.</p><h5 id="1024-other-uses-for-principal-components">10.2.4 Other Uses for Principal Components</h5><p>차원 축소를 통해서 regression, classification, clustering에 모두 사용될 수 있다. 차원 축소가 잘 된다면 데이터의 nosie를 줄여 보다 올바른 결과가 나올 수도 있다.</p><h4 id="103-clustering-methods">10.3 Clustering Methods</h4><p>군집화를 할 때는 무엇이 같고 무엇이 다른 것인지에 대한 기준이 필요하다. 이는 domain 지식을 요구할 수도 있다. pca와 clustering은 데이터를 단순화 시킨다는 데서 공통점이 있지만, pca는 feature의 dimension을 줄이려는 시도이고, clustering은 obs안에서 subgroup을 찾으려는 시도라는 데서 차이점이 존재한다.</p><p>그런데 clustering 과정에서 X matrix를 transpose한다고 하면 obs를 기반으로 해서 feature를 나누는 시도 또한 가능하다. 이는 새롭게 배우는 idea인데 충분히 생각해볼 필요가 있다.</p><h5 id="1031-k-means-clustering">10.3.1 K-Means Clustering</h5><p>바람직한 K를 clustering 이전에 미리 정해야한다. 또한 각 clusteing은 서로 겹치지 않아야 하며 그 합이 전체 데이터 set을 만들어야 한다</p><p>K-Means의 아이디어는 무엇인가? 우선 각 cluster 내부의 데이터들은 작은 분산을 가질 것이라는 것이다. 각 cluster의 within-variance를 W라고 하면 clustering의 문제는 아래의 식을 푸는 것과 동일하게 된다.</p>\[minimize _{ C_1, C_2,...,C_k} \{\ \sum^K W(C_k)\}\]<p>W를 정의하는 방법은 여러가지가 있지만 책에서는 pairwise squared Euclidean distance의 총합을 cluster의 원소 개수로 나누는 것을 제시한다</p>\[W(C_k) = \frac { 1} {|W_k|}\sum_{i,i' \in C_k} \sum _j ^ K (x_{ij} - x_{i'j})^2\]<p>그런데 이런 방식은 계산량이 매우 많다. K^n 만큼의 경우가 존재.</p><p>따라서 local optimum을 찾는 방식의 알고리즘이 존재한다.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr10-4.png" width="70%" height="70%" title="1" alt="relative" /></p><p>알고리즘에서는 K-Means 라는 명칭에 걸맞게 평균을 사용해서 clustering을 하는데 이것이 가능한 이유는 아래와 같다. 앞서 말했던 within-variance를 최소화 하는 식은 다음 식과 동일하다</p>\[\frac { 1} {|W_k|}\sum_{i,i' \in C_k} \sum _j ^ K (x_{ij} - x_{i'j})^2 = 2\sum_{i\in C_k}\sum_{j=1}^K(x_{ij} - \bar x_{kj})^2\]<p>즉 분산을 최소화하는 값이 바로 clustering 내부의 평균값과의 차이 합인 것이다.</p><p>그러나 여전히 이러한 방법은 global opitmum이 아닌 local optimum이므로 초기값을 다양하게 설정함으로써 clustering이 보다 잘 되게 할 수 있다. 알고리즘의 결과치를 비교할 때에는 within-variance의 총합을 최소로 하는 clustering을 찾는다.</p><p>아래는 알고리즘을 그림으로 표현한 것이다</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr10-5.png" width="70%" height="70%" title="1" alt="relative" /></p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr10-6.png" width="70%" height="70%" title="1" alt="relative" /></p><h5 id="1032-hierarchical-clustering">10.3.2 Hierarchical Clustering</h5><p>K-Means와는 달리 K 값을 미리 정하지 않아도 된다. 결과값으로 tree-based representation을 준다. 이를 dendrogram이라고 한다.</p><p>핵심용어는 bottom - up, agglomerative clustering, upside-down tree</p><h5 id="interpreting-a-dendrogram">Interpreting a Dendrogram</h5><p>dendrogram에서 관측지들이 유사할수록 더 빨리(dengrogram의 아랫부분) 결합될 것이다.</p><p>또한 dendrogram은 vertical axis를 기준으로 유사성을 판단하게 되는데, 서로 다른 brach이면 그 값들이 horizontal 하게 떨어져있을 때는 유사성이 차이가 없다. 아래 그림을 참조</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr10-7.png" width="70%" height="70%" title="1" alt="relative" /></p><p>그럼 clustering을 어떻게 할 것인가? horizontal cut을 사용. horizontal cut을 어떻게 하는가에 따라 cluster K 값이 달라진다. 아래 그림의 점선이 horizontal cut을 나타내고, 그에 따른 clustering을 보여준다.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr10-8.png" width="70%" height="70%" title="1" alt="relative" /></p><p>heirarchical의 의미는 cutting에 의한 cluster들이 다른 cluster 에 nested 되어 있다는 것이다. 그러나 모든 데이터에서 이런 계층적 구조가 발생하는 것은 아니다. 예를들어 남 / 녀, 한/ 중/ 일 데이터를 성별, 그리고 국적으로 clustering 할 수 있겠지만 어떤 cluster가 다른 cluster 안에 계층적으로 포함되지는 않는다.</p><h5 id="the-hierarchical-clustering-algorithm">The Hierarchical Clustering Algorithm</h5><p>알고리즘은 다소 단순하다. 관측치가 n개 있을 때, 유클리디안 거리를 기준으로 dendrogram의 제일 하단 부분에서 가장 유사한 두 관측치를 결합해서 n-1개의 cluster를 만든다. 마찬가지 방식으로 n-2, n-3, … 으로 cluster의 개수를 줄여나가고 dendrogram의 제일 윗 부분에서는 하나의 cluster만이 남는다.</p><p>이제 또 다른 문제를 살펴보자. 관측치들의 여러개 들어있는 그룹들의 거리는 어떻게 측정할 수 있을까? 이를 위해 linkage 라는 개념이 등장한다. 그 종류로는 Complete, Single, Average, Centroid가 있고 각 likage 마다 dissimilarity를 측정하는 다른 기준이 있다. 일반적으로 complete이나 average linkage는 single linkage 에 비해 훨씬 균형적이다. 또한 Centroid linkage는 inversion의 위험이 있다.</p><p>hierarchical 알고리즘과 linkage에 대한 내용이 책에 나온다.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/islr10-9.png" width="70%" height="70%" title="1" alt="relative" /></p><h5 id="choice-of-dissimilarity-measure">Choice of Dissimilarity Measure</h5><p>지금까지는 유클리디안 거리를 기준으로 dissimilarity를 체크했는데 다른 방식의 측도에 대해서 알아보자.</p><p>correlation-based distance는 두 obs 간의 상관성을 비교하는 것으로 유클리디안 거리가 크기를 가지고 비교했다면, correlation-based distance는 관측치 profile의 모양을 가지고 dissimilarity를 판단하는 것이다. 어떠한 기준을 선택하는지는 데이터의 형태 혹은 분석의 목적에 따라 달라진다. 예를들어 마케팅 팀에서 소비자들을 대상으로 군집분석을 하는데, 구매 패턴이 비슷한 소비자를 같은 그룹으로 할지, 아니면 소비액이 유사한 소비자를 같은 그룹으로 할지 차이가 있는 것이다.</p><p>또한 변수를 표준화하는 것에 따라 dissimilarity가 달라질 수 있으므로 이데 대해서도 고려해야한다(K-means 도 마찬가지)</p><h5 id="1033-practical-issues-in-clustering">10.3.3 Practical Issues in Clustering</h5><p>clustering 과정에서 고려해야할 부분이 몇가지 있다.</p><p>(1) Small Decisions with Big Consequences</p><ol><li>obs 혹은 feature가 standardize 되어야 한다. 왜? 분산으로 clustering을 하기 때문에<li>hierarchical clustering 의 경우 - dissimilarity measure / linkage / where to cut the dendrogram<li>K-Means cluster에서 K의 값은?</ol><p>(2) Validating the Cluster Obtained</p><p>clustering이 제대로 된 것일까? 아님 noise 때문에 우연히 cluster 된 것일까? 이를 평가하는 기준은?</p><p>p - vlaue로 cluster가 우연에 의한 것인지 아닌지를 평가하는 방법이 있긴한데 이 또한 학자들이 모두 인정한 그런 방식은 아니다.</p><p>(3) Other Considerations in Clustering</p><p>clustering 은 데이터의 작은 변동에도 크게 바뀐다( robust X)</p><p>대다수의 obs가 몇개의 소그룹에 속해있는 경우, 그리고 그 소그룹들이 서로 매우 다른 경우 ==&gt; clustering에 왜곡이 일어날 수 있다. clustering 은 특정 그룹에 데이터를 강제로 분류하기 때문에. 이를 막기위해 mixture model을 사용한 soft K-means 가 등장</p><p>(4)</p><p>clustering을 하는 여러가지 방법을 배웠는데(standardize, linkage,…) 이들을 모두 사용해서 반복적으로 나타나는 패턴이 있는지 파악하는 것이 중요. non - robust한 성질을 가지고 있기 때문에, clustering을 절대적인 분류로 생각하지 말고, 연구를 하는데 어느정도의 도움을 얻고 또 출발점이 되는 그런 정도의 용도로 사용하는게 좋다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/datascience/" class="post-tag no-text-decoration" >datascience</a> <a href="/tags/datamining/" class="post-tag no-text-decoration" >datamining</a> <a href="/tags/machinelearning/" class="post-tag no-text-decoration" >machinelearning</a> <a href="/tags/islr/" class="post-tag no-text-decoration" >ISLR</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ISLR chap 10 - For Statistics&url=https://hwankam.github.io/posts/ISLR10/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ISLR chap 10 - For Statistics&u=https://hwankam.github.io/posts/ISLR10/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=ISLR chap 10 - For Statistics&url=https://hwankam.github.io/posts/ISLR10/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/PRML6/">PRML-6</a><li><a href="/posts/PRML5/">PRML-5</a><li><a href="/posts/PRML4/">PRML-4</a><li><a href="/posts/PRML3/">PRML-3</a><li><a href="/posts/CASI9/">Computer Age Statistical Inference - chap 9</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/datamining/">datamining</a> <a class="post-tag" href="/tags/machinelearning/">machinelearning</a> <a class="post-tag" href="/tags/islr/">ISLR</a> <a class="post-tag" href="/tags/statistical-method/">statistical method</a> <a class="post-tag" href="/tags/efron/">Efron</a> <a class="post-tag" href="/tags/prml/">PRML</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/categorical-data/">categorical data</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ISLR2/"><div class="card-body"> <span class="timeago small" >Jul 29, 2021<i class="unloaded">2021-07-29T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ISLR chap 2</h3><div class="text-muted small"><p> 2.1 What is statistical learning? 2.1.1 X : predictor, features, independent variable Y : response, dependent variable $ Y = f(X) + \epsilon $ $ \hat Y = \hat f(X) $ reducible error : Y를 ...</p></div></div></a></div><div class="card"> <a href="/posts/ISLR2-LAB/"><div class="card-body"> <span class="timeago small" >Jul 30, 2021<i class="unloaded">2021-07-30T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ISLR - LAB2</h3><div class="text-muted small"><p> R 코드 정리 #할당, c는 백터를 의미 x &lt;- c(1,2,3,4) # 백터의 원소 개수 length(x) #저장되어 있는 변수 모두 호출 ls() #remove rm(x) rm(list=ls()) #행렬 x = matrix(data=c(1,2,3,4), nrow=2, ncol=2) x y = matrix(data=c(1,2,3,4), nr...</p></div></div></a></div><div class="card"> <a href="/posts/ISLR3-LAB/"><div class="card-body"> <span class="timeago small" >Jul 30, 2021<i class="unloaded">2021-07-30T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ISLR - LAB3</h3><div class="text-muted small"><p> R 코드 정리 library(MASS) fix(Boston) #table 형태로 보여주기 names(Boston) # 열 이름 보여주기 attach(Boston) lm.fit = lm( medv ~ lstat) summary(lm.fit) """ Call: lm(formula = medv ~ lstat) Residuals: Min ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ISLR9/" class="btn btn-outline-primary" prompt="Older"><p>ISLR chap 9</p></a> <a href="/posts/ISLR10-LAB/" class="btn btn-outline-primary" prompt="Newer"><p>ISLR - LAB10</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/datamining/">datamining</a> <a class="post-tag" href="/tags/machinelearning/">machinelearning</a> <a class="post-tag" href="/tags/islr/">ISLR</a> <a class="post-tag" href="/tags/statistical-method/">statistical method</a> <a class="post-tag" href="/tags/efron/">Efron</a> <a class="post-tag" href="/tags/prml/">PRML</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/categorical-data/">categorical data</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}}); </script> MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) { alert("Math Processing Error: "+message[1]); }); MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) { alert("Math Processing Error: "+message[1]); }); </script> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
