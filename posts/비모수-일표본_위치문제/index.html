<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Nonparametric - one sample location" /><meta property="og:locale" content="en" /><meta name="description" content="범주형 자료분석의 보조자료를 정리한 글이다. 비모수통계학의 일표본 위치문제와 permutation test에 관한 내용들을 정리해보겠다." /><meta property="og:description" content="범주형 자료분석의 보조자료를 정리한 글이다. 비모수통계학의 일표본 위치문제와 permutation test에 관한 내용들을 정리해보겠다." /><link rel="canonical" href="https://hwankam.github.io/posts/%EB%B9%84%EB%AA%A8%EC%88%98-%EC%9D%BC%ED%91%9C%EB%B3%B8_%EC%9C%84%EC%B9%98%EB%AC%B8%EC%A0%9C/" /><meta property="og:url" content="https://hwankam.github.io/posts/%EB%B9%84%EB%AA%A8%EC%88%98-%EC%9D%BC%ED%91%9C%EB%B3%B8_%EC%9C%84%EC%B9%98%EB%AC%B8%EC%A0%9C/" /><meta property="og:site_name" content="For Statistics" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-02T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Nonparametric - one sample location" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"범주형 자료분석의 보조자료를 정리한 글이다. 비모수통계학의 일표본 위치문제와 permutation test에 관한 내용들을 정리해보겠다.","url":"https://hwankam.github.io/posts/%EB%B9%84%EB%AA%A8%EC%88%98-%EC%9D%BC%ED%91%9C%EB%B3%B8_%EC%9C%84%EC%B9%98%EB%AC%B8%EC%A0%9C/","headline":"Nonparametric - one sample location","dateModified":"2021-11-03T21:36:47+09:00","datePublished":"2021-11-02T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://hwankam.github.io/posts/%EB%B9%84%EB%AA%A8%EC%88%98-%EC%9D%BC%ED%91%9C%EB%B3%B8_%EC%9C%84%EC%B9%98%EB%AC%B8%EC%A0%9C/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>Nonparametric - one sample location | For Statistics</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="For Statistics"><meta name="application-name" content="For Statistics"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">For Statistics</a></div><div class="site-subtitle font-italic">kam's world</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Hwankam" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Nonparametric - one sample location</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Nonparametric - one sample location</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> your_full_name </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Nov 2, 2021, 12:00 AM +0900" >Nov 2, 2021<i class="unloaded">2021-11-02T00:00:00+09:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Nov 3, 2021, 9:36 PM +0900" >Nov 3, 2021<i class="unloaded">2021-11-03T21:36:47+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2854 words">15 min read</span></div></div><div class="post-content"><p>범주형 자료분석의 보조자료를 정리한 글이다. 비모수통계학의 일표본 위치문제와 permutation test에 관한 내용들을 정리해보겠다.</p><h2 id="1-two-sample-location-problem">1. Two-sample location problem</h2><h3 id="11-independent-sample">1.1 Independent sample</h3><p>Test</p><ul><li>Parmetric test : independent two sample t-test<li>Permutation test(resampling method의 일종으로 permutation test는 p-value를 찾는데 사용하며 without-replacement를, bootstrap의 경우 SE 추정을 하며 with-replacement를 사용한다)<li>Non-parametric test : Wilcoxon rank sum test, Mann-Whitney test</ul><p><br /></p><h4 id="parametric-test">parametric test</h4><p>Assumtion : $ N(\theta_x, \sigma^2) , N(\theta_y,\sigma^2)$ (homoscadescity) (<em>Normality</em>)</p><p>Null hypothesis : $\theta_x = \theta_y $</p><p>Test statistic : $T = \frac {\bar Y - \bar X - (\theta_y - \theta_x)} {S_p \sqrt{1/m + 1/n}} \sim t_{m+n-2}$</p><p><br /></p><h4 id="wilcoxon-rank-sum-test-여기서도-exact-test-와-asymtotic-test-로-나뉜다">Wilcoxon Rank Sum Test (여기서도 exact test 와 asymtotic test 로 나뉜다)</h4><p>Two sample t test 와 달리 정규성가정이 필요없다(: 비모수적 검정) <strong>그러나 윌콕슨 순위검정은 샘플들을 섞기 때문에 등분산에 대한 가정은 존재해야만 샘플을 섞는것이 의미 있을 것이다</strong></p><p>Null hypothesis : $\theta_x = \theta_y $</p><p>Test statistic : $W = \sum_i R_i$</p><p>이 때 $R_i$는 두 집단의 샘플을 마구 섞은 뒤, 순위를 매기고 그 중 Y 샘플에 해당하는 순위만을 합한 것.<br /> X 샘플에 해당하는 순위를 매기고 이를 합한 것을 $W’$라고 하면 $W + W’ = N(N+1)/2$</p><p>예시) X sample 두개, Y sample 두개 인 경우 $W$의 분포는 아래와 같을 것이다.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/cda_non_1.png" width="70%" height="70%" title="1" alt="relative" /></p><ul><li>Exact test</ul><p>위 상황에서 우리가 얻은 샘플이 $W = 3$ 이라면, 대립가설이 $\theta_x \neq \theta_y$ 일 때, p-value는 $ W = 3 \ and \ 7 $일 때의 확률값을 더해주면 된다. 따라서 p-value = 1/3</p><p>만약 대립가설이 $\theta_x &gt; \theta_y$ 라면 p-value는 $ W \leq 3 $일 때의 확률값을 더해주면 된다. 따라서 p-value = 1/6</p><p>만약 대립가설이 $\theta_x &lt; \theta_y$ 라면 p-value는 $ W \geq 3 $일 때의 확률값을 더해주면 된다. 따라서 p-value = 1</p><p><em>참고</em></p><p>추가적으로 $ W $의 평균과 분산을 구할 수 있다.</p><p>$p(R_i = s) = 1/N \ \ , \ S = 1,2,…,N$ 일 때</p><p>$E(W_0) = n(N+1)/2 \ \ , \ \ $ $Var( W_0) = nm(N+1)/12$</p><p><br /></p><ul><li>Asympototic test -&gt; Normal</ul><p>CLT 에 의해, $ W \sim N(E(W), Var(W))$ 이므로 이를 활용해서 Z 값을 만들어 준다.</p><p><br /></p><h4 id="t-statistics-based-permutation-test-1">t-statistics-based permutation test 1</h4><p>permutation test 는 t 통계량(어떠한 통계량이든 상관없음)을 가져다 쓰나, t-분포를 요구하지는 않는다. 그 말인 즉슨 Normality 가정을 요구하지 않고 empirical distribution으로부터 가설검정을 하겠다는 것이다.</p><p>B번의 permutations이 행해진 뒤에 아래와 같은 값으로 p-value를 구한다.(permuation의 최대 횟수는 샘플의 개수에 따라 다르다)</p>\[p = \frac {\sum I(|t^{b}| \geq |t_0|)} {B}\]<p><em>permutation test는 exact p-value를 구한다</em></p><p><br /></p><h4 id="t-statistics-based-permutation-test-2">t-statistics-based permutation test 2</h4><p>Assumtion : $N(\theta_x, \sigma_x^2) , N(\theta_y,\sigma_y^2)$ (homoscadescity) (<em>Normality</em>)</p><p>Null hypothesis : $\theta_x = \theta_y $</p><p>statistic : $T = \frac {\bar Y - \bar X} {\sqrt{S_1^2/m + S_2^2/n}} $</p><p>통계량을 사용해서 permutation test 진행</p><p><br /></p><h4 id="t-statistics-based-permutation-test-3">t-statistics-based permutation test 3</h4><p>프린트 상으로는 여기에 같이 설명되어 있으나, 이것은 one-sample location 문제이다.</p><p>$X_i \sim \ iid \ f_{\theta}(x) = f_0(x-\theta)$</p><p>Null hypothesis : $\theta = \theta_0 $</p><p>Test statistic : T = $\frac {\bar X - \theta_0} {S/\sqrt{n}} \sim t_{n-1} $</p><p>이제 statistic 을 활용해서 permutation test를 진행한다.</p><p>permuation을 하기 위해서는 부호를 사용한다. f 의 평균이 $\theta$이므로 이를 shift 해서 $x_i - \theta$ 의 샘플을 만들고 난 뒤, 부호를 준다.<br /> sample { $x_i - \theta $ }를 모아놓은 벡터와 (-1,1)에서 샘플 개수 n개 만큼 복원 추출한 벡터를 서로 element-wise product하고, 이를 활용해서 통계량 $T^b$ 를 구한다. 이를 B번 반복해서 p-value를 구한다.</p>\[p = \frac {\sum I(|T^{b}| \geq |T_0|)} {B}\]<p><br /></p><h5 id="comparison-of-wilcoxon-test-with-permutation-test">Comparison of Wilcoxon test with permutation test</h5><div class="table-wrapper"><table><thead><tr><th> <th>t-test<th>t-permutation<th>Wilcoxon<tbody><tr><td>Distribution<td>Normal<td>No<td>No<tr><td>Information<td>Mean, Variance<td>Mean, Variance<td>Rank<tr><td>Robustness to skewness<td>No<td>Yes<td>Yes<tr><td>Robustness to outliers<td>No<td>No<td>Yes</table></div><p><br /></p><p>Wilcoxon rank test는 robustness to outlier 이지만 정보를 모두 순위로 바꾸기 때문에 오히려 정보를 잃어버린다는 단점.</p><p><br /></p><h3 id="12-paried-comparison">1.2 Paried comparison</h3><p>confounding effect 를 막을 수 있다. 즉 비교하고 싶은 두 효과의 차이만을 오롯이 비교할 수 있다.</p><p>Test</p><ul><li>Parmetric test : t-test for the difference<li>Permutation test<li>Non-parametric test : Wilcoxon <strong>signed</strong> rank test<h4 id="parametric-test-1">parametric test</h4></ul><p>샘플이 pair 이므로 correlation이 존재한다 $\Longrightarrow T = \frac {\bar Y - \bar X - (\theta_y - \theta_x)} {S_p \sqrt{1/m + 1/n}} $ 를 사용할 수 없고 $T = \frac {\bar Y - \bar X - (\theta_y - \theta_x)} {SE(\bar D)} \sim T_{n-1} $ 만을 사용해야 한다.</p><p><br /></p><h4 id="non-parametric-test">Non-parametric test</h4><ol><li>샘플의 부호를 모두 제거한 채로 오름차순 정렬한 뒤, 순위값 $R_i$을 준다<li>$T = \sum sgn(X_i) R_i$ 으로 test statistic을 정한다.<li>p-value 계산</ol><p><br /></p><h2 id="2-one-way-anova-probelm">2. One-way ANOVA probelm</h2><p>One-way는 factor(treatment) 가 하나인 경우 <br /> ANOVA는 two sample test 를 확장해서 여러개의 샘플(집단)을 비교하는 것. <br /> one-way ANOVA 가정 : 등분산성이 기본가정!, 만약 두 집단의 분산이 다르다면? $\rightarrow $ log transformation 해준 다음에 ANOVA 해줘야 함.</p><h4 id="parmetric-method">Parmetric method</h4><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 70% 70%'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/cda_non_2.png" width="70%" height="70%" title="1" alt="relative" /></p><p>test statistic $F = \frac {SStr/(k-1)} {SSE/(N-k)} \sim F_{k-1, N-k}$</p><p><br /></p><h4 id="non-parametric-method">Non-parametric method</h4><p>Kruskal-Wallis test (wilcoxon rank test 의 확장) - Exact test</p><p>test statistic H 는 아래와 같다</p>\[H = \frac {12}{N(N+1)} \sum_{i=1} ^k n_i(\bar R_{i.}- \bar R_{..})^2\]<p><br /></p><h4 id="permutation">Permutation</h4><p>방식은 동일하다. 통계량은 어떠한 것을 사용해도 괜찮기 때문</p>\[p = \frac {\sum I(|F^{b}| \geq |F_0|)} {B}\]<p><br /></p><h2 id="3-correlation-analysis">3. Correlation analysis</h2><p>Test</p><ul><li>Parmetric test : Pearson’s correlation coefficient =&gt; t-test<li>Permutation test<li>Non-parametric test : Spearman rank correlation</ul><h4 id="parmetric-method-1">Parmetric method</h4><p>bivariate normal distribution으로부터 아래와 같은 변환으로 통해 t 분포를 유도할 수 있다</p><p>귀무가설 $H_0 : \rho = 0$ 로부터</p>\[T = \sqrt{n-2} \frac {r} {\sqrt{1-r^2}} \ \ \sim t_{n-2}\]<p>만약 normality 가정이 만족하지 않는다면 permuation test나 혹은 spearman rank correlation, Kendall rank correlation 을 사용한다.</p><p><br /></p><h4 id="permuation-test">Permuation test</h4><p>paired data (X,Y)을 사용해서 새로운 데이터 set (X’, Y’) 을 만들 것이다.<br /> 귀무가설 $H_0 : \rho = 0$ 이므로 귀무가설하에서는 x와 y가 서로 독립이므로 random하게 섞을 수 있다.</p><p><br /></p><h4 id="non-parametric">Non-parametric</h4><p>spearman rank correlation : 두 집단의 샘플 내부에서 각각의 순위를 정해서 $R_i^X , R_i^Y$ 라고 한다. 이 때 Spearman correlation은</p>\[R_s = \frac {\sum (R_i^X - \bar R)(R_i^Y - \bar R)} {\sqrt{\sum (R_i^X - \bar R)^2} \sqrt{\sum (R_i^Y - \bar R)^2}}\]<p>where $\bar R = (n+1)/2 $</p><p>Asymtotic distribution을 구하고 싶다면, $\sqrt{n-1} R_s \sim N(0,1)$</p><p>참고 : pearson sample corr 같은 경우 $ \gamma \approx N(\rho, \frac {(1-\rho^2)^2}{n}) $</p><p><br /></p><h2 id="4-regression-analysis">4. Regression Analysis</h2><h4 id="permutation-test-only">Permutation test only</h4><p>여기서부터는 Permutation tests for univariate or multivariate analysis of variance and regression - Marti J. Anderson 의 글을 참고했다.</p><p>permutation test 의 rationale :</p><p>관찰값으로부터의 통계량과 귀무가설하에서 나올 수 있는 모든 경우의 통계량들의 분포를 비교하는 것. 이때 나올 수 있는 모든 경우라는 것은, 실험 디자인이 random하게 변하는 것으로부터 나오는 것이고 샘플자체, 그리고 error term은 바뀌지 않는 것이다. 즉 고정된 샘플에서 permuation이 행해지는 것을 의미한다.</p><p>실험 디자인이 random하게 변한다는 것은 test의 validity를 보장할 수 있다는 것이다. 즉 연구자가 정한 type 1 error 의 값을 유지하면서 실험 결과를 얻어낼 수 있다. 이것은 마치 일반적으로 perametric method of test에서 normality를 가정하거나 asymtotic normality를 얻는 것과 일맥상통한다고 할 수 있겠다.</p><p><br /></p><h5 id="simple-linear-regression">simple linear regression</h5><p>permutation test를 위해서는 귀무가설 하에서 exchangeable한 것을 찾아내야 한다.<br /> model $Y = \beta_0 + \beta_1 X + \epsilon $ 일 때, 귀무가설 $H_0 : \beta_1 = 0$ 하에서는 Y 는 X와는 무관하기 때문에 이를 randomly permute 가능하다. 이후에는 permutation 된 (X,Y)를 사용해서 원하는 통계량을 구한 뒤 p-value를 찾아낸다.</p><p>이러한 논리는 multiple linear regression $Y = \beta_0 + \beta_1 X + \beta_2 Z + \epsilon $ 에서 귀무가설이 $H_0 : \beta_1 = \beta_2 = 0$ 일 때에도 동일하게 적용될 것이다.</p><p><br /></p><h5 id="multiple-linear-regression">multiple linear regression</h5><p>multiple linear regression 중 partial regression에 대해 알아보면,</p><p>model : $Y = \beta_0 + \beta_1 X + \beta_2 Z + \epsilon $</p><p>null hypothesis : $H_0 : \beta_2 = 0$</p><p>인 경우, 검정하고 싶은 대상은 “relationship between Y and Z given X 이다. simple linear regression과 동일한 논리로 접근하면, 귀무가설 하에서 무엇이 exchangeable 한 것인지 찾아야한다. 귀무가설 하에서의 model $ Y = \beta_0 + \beta_1 X + \epsilon $ 에서 X 혹은 Y를 permute 하게 되면 $\beta_1$의 실제 값이 바뀌기 때문에 exchange에 주의해야 한다. 귀무가설하에서 실제로 exchange 가능한 것은 $ Y - \beta_0 - \beta_1 X $ 인데 베타 값에 대한 참값을 알 수 없기 때문에 추정치인 $\hat \beta$를 사용해서 잔차를 구하고 잔차를 permute 한다. 그런 다음 실제로 알고 싶은 관계를 나타내는 변수인 Z와 잔차의 linear 모델을 만들어서 귀무가설을 검정하게 된다.</p><p>이외에도 multiple linear regression에서 몇가지 소개할 방법들이 있다.</p><p>첫번째로 소개할 것은 R- package의 glmperm 작동원리가 되는 방법이다. 가설과 모델이 모두 위와 동일할 때, 귀무가설하에서 얻어낸 잔차값을 Z 를 대신해 모델에서 사용하는 것이다. 즉 잔차 $\gamma$에 대해 모델 $Y = \beta_0 + \beta_1 X + \beta_2 \gamma + \epsilon $ 을 가지고 test를 진행할 것이다.</p><p>여기서는 LR statistic을 찾아낸다. 잔차값을 permutation(without replacement) 한 뒤 각각 case 에 대해서 LR statistic을 구해 카이제곱분포로 근사시켜 p-value까지 직접 구한다. 그런 다음 permutation case에 대한 p-value $p_b^*$ 에 대해 최종적인 p-value 로</p>\[p = \frac {\sum I(p_b^* \leq f*p)} {B}\]<p>로 p-value 를 구한다.(여기서 f의 값은 numerical instability를 고려한 1과 가까운 매우 작은 값이다.)</p><p>두번째로 소개할 방법은 만약 잔차를 계산하는 것의 비용이 많이 들 때의 해결방법이다. 이때는 X와 Z를 고정 시키고 Y를 permute 해서 귀무가설을 검정할 수는 있겠으나, 이 경우 X의 outlier가 존재할 때 상응하는 Y의 값이 random allocation에 의해 관계를 잃어버리게 된다는 한계가 있으므로 주의해야 한다 (sample size가 작을 때 좋을 것)</p><p>마지막 방법으로는 residual을 이용하되, 대립가설하에서 exchangeablility를 보는 것이다. 즉 full model하에서의 잔차를 구하고 permute 한 뒤, 이를 검증하고 싶은 변수와 적합해서 계수값에 대한 p-value를 구하는 것이다. 이 값은 각 가설하에서 error term의 분포에 기반한 검정이므로 표본이 매우 작을 경우에는 사용하기 어렵다( 표본이 크면 정규근사하기 때문에 error term의 분포가 각 가설하에서 다르더라도 표본이 클 경우 사용가능하다는 말!)</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/nonparametric/" class="post-tag no-text-decoration" >Nonparametric</a> <a href="/tags/permutation-test/" class="post-tag no-text-decoration" >permutation test</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Nonparametric - one sample location - For Statistics&url=https://hwankam.github.io/posts/%EB%B9%84%EB%AA%A8%EC%88%98-%EC%9D%BC%ED%91%9C%EB%B3%B8_%EC%9C%84%EC%B9%98%EB%AC%B8%EC%A0%9C/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Nonparametric - one sample location - For Statistics&u=https://hwankam.github.io/posts/%EB%B9%84%EB%AA%A8%EC%88%98-%EC%9D%BC%ED%91%9C%EB%B3%B8_%EC%9C%84%EC%B9%98%EB%AC%B8%EC%A0%9C/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Nonparametric - one sample location - For Statistics&url=https://hwankam.github.io/posts/%EB%B9%84%EB%AA%A8%EC%88%98-%EC%9D%BC%ED%91%9C%EB%B3%B8_%EC%9C%84%EC%B9%98%EB%AC%B8%EC%A0%9C/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/PRML6/">PRML-6</a><li><a href="/posts/PRML5/">PRML-5</a><li><a href="/posts/PRML4/">PRML-4</a><li><a href="/posts/PRML3/">PRML-3</a><li><a href="/posts/CASI9/">Computer Age Statistical Inference - chap 9</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/datamining/">datamining</a> <a class="post-tag" href="/tags/machinelearning/">machinelearning</a> <a class="post-tag" href="/tags/islr/">ISLR</a> <a class="post-tag" href="/tags/statistical-method/">statistical method</a> <a class="post-tag" href="/tags/efron/">Efron</a> <a class="post-tag" href="/tags/prml/">PRML</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/categorical-data/">categorical data</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/PRML6/"><div class="card-body"> <span class="timeago small" >Mar 1<i class="unloaded">2022-03-01T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PRML-6</h3><div class="text-muted small"><p> 6. Kernel Methods [서론] there is a class of pattern recognition techniques ==&gt; training data points are kept, memory based method ex ) nearest neighborhood 방법은 training data와 가장 유사한 label을 te...</p></div></div></a></div><div class="card"> <a href="/posts/PRML5/"><div class="card-body"> <span class="timeago small" >Feb 9<i class="unloaded">2022-02-09T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PRML-5</h3><div class="text-muted small"><p> 5. Neural Networks chap 3과 4에서는 linear combination of fixed bases function에 대해 배웠다. 그러나 high dimension에서는 과적합의 문제가 발생하는 한계가 있었다. 이를 해결하기 위해 데이터에 맞게 basis function을 바꾸는 것은 어떠할까? SVM은 데이터에 맞게 hyper...</p></div></div></a></div><div class="card"> <a href="/posts/PRML4/"><div class="card-body"> <span class="timeago small" >Jan 19<i class="unloaded">2022-01-19T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PRML-4</h3><div class="text-muted small"><p> 4. Linear Models for Classification 이번 chapter는 “Input space를 K개의 Class로 나누는 것”이 핵심이다. 이때 나눠지는 영역은 decision region, 나누는 boundary를 decision boundary 혹은 decision surface라 한다. 특히 이번 chapter에서 중요한 것은 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ROC_AUC/" class="btn btn-outline-primary" prompt="Older"><p>CDA - ROC/AUC</p></a> <a href="/posts/CASI9/" class="btn btn-outline-primary" prompt="Newer"><p>Computer Age Statistical Inference - chap 9</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/datamining/">datamining</a> <a class="post-tag" href="/tags/machinelearning/">machinelearning</a> <a class="post-tag" href="/tags/islr/">ISLR</a> <a class="post-tag" href="/tags/statistical-method/">statistical method</a> <a class="post-tag" href="/tags/efron/">Efron</a> <a class="post-tag" href="/tags/prml/">PRML</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/categorical-data/">categorical data</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}}); </script> MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) { alert("Math Processing Error: "+message[1]); }); MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) { alert("Math Processing Error: "+message[1]); }); </script> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
