<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="ISLR - LAB7" /><meta property="og:locale" content="en" /><meta name="description" content="7장 코드 정리" /><meta property="og:description" content="7장 코드 정리" /><link rel="canonical" href="https://hwankam.github.io/posts/ISLR7-LAB/" /><meta property="og:url" content="https://hwankam.github.io/posts/ISLR7-LAB/" /><meta property="og:site_name" content="For Statistics" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-06T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ISLR - LAB7" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"7장 코드 정리","url":"https://hwankam.github.io/posts/ISLR7-LAB/","headline":"ISLR - LAB7","dateModified":"2021-10-17T16:26:05+09:00","datePublished":"2021-08-06T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://hwankam.github.io/posts/ISLR7-LAB/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>ISLR - LAB7 | For Statistics</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="For Statistics"><meta name="application-name" content="For Statistics"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">For Statistics</a></div><div class="site-subtitle font-italic">kam's world</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Hwankam" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>ISLR - LAB7</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>ISLR - LAB7</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> your_full_name </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Aug 6, 2021, 12:00 AM +0900" >Aug 6, 2021<i class="unloaded">2021-08-06T00:00:00+09:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 17, 2021, 4:26 PM +0900" >Oct 17, 2021<i class="unloaded">2021-10-17T16:26:05+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1135 words">6 min read</span></div></div><div class="post-content"><h3 id="7장-코드-정리">7장 코드 정리</h3><div class="language-R highlighter-rouge"><div class="code-header"> <span text-data=" R "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
</pre><td class="rouge-code"><pre><span class="c1">##Non - linear modeling</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ISLR</span><span class="p">)</span><span class="w">
</span><span class="n">attach</span><span class="p">(</span><span class="n">Wage</span><span class="p">)</span><span class="w">

</span><span class="c1">#polynomial</span><span class="w">
</span><span class="n">fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">wage</span><span class="o">~</span><span class="n">poly</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">Wage</span><span class="p">)</span><span class="w"> </span><span class="c1">#orthogonal polynomial</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">))</span><span class="w">

</span><span class="s2">"""
                Estimate Std. Error    t value     Pr(&gt;|t|)
(Intercept)    111.70361  0.7287409 153.283015 0.000000e+00
poly(age, 4)1  447.06785 39.9147851  11.200558 1.484604e-28
poly(age, 4)2 -478.31581 39.9147851 -11.983424 2.355831e-32
poly(age, 4)3  125.52169 39.9147851   3.144742 1.678622e-03
poly(age, 4)4  -77.91118 39.9147851  -1.951938 5.103865e-02
"""</span><span class="w">

</span><span class="n">fit2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">wage</span><span class="o">~</span><span class="n">poly</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">),</span><span class="w"> </span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">summary</span><span class="p">(</span><span class="n">fit2</span><span class="p">))</span><span class="w">
</span><span class="s2">"""
                            Estimate   Std. Error   t value     Pr(&gt;|t|)
(Intercept)            -1.841542e+02 6.004038e+01 -3.067172 0.0021802539
poly(age, 4, raw = T)1  2.124552e+01 5.886748e+00  3.609042 0.0003123618
poly(age, 4, raw = T)2 -5.638593e-01 2.061083e-01 -2.735743 0.0062606446
poly(age, 4, raw = T)3  6.810688e-03 3.065931e-03  2.221409 0.0263977518
poly(age, 4, raw = T)4 -3.203830e-05 1.641359e-05 -1.951938 0.0510386498
"""</span><span class="w">

</span><span class="c1">#orthogonal polynomial은 제곱항 세제곱항 등이 가지는 높은 상관계수를 제거한 변수들이다. 회귀계수 추정값을 보면 orthogonal poly일 때 추정 계수 값이 훨씬 크다. 그러나 단점으로는 orthogonal 변수로 바뀌었기 때문에 모델의 해석력이 떨어진다.</span><span class="w">

</span><span class="c1">#orthogonal인지 아닌지는 모델의 의미 자체에는 영향을 안준다. 즉 fitted value는 orthogonal 여부에 상관없이 동일하다. </span><span class="w">

</span><span class="c1">#raw=TRUE와 같은 polynomial regression은 아래 두가지이다.</span><span class="w">
</span><span class="n">fit2a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">wage</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="n">age</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="n">age</span><span class="o">^</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="n">age</span><span class="o">^</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">fit2a</span><span class="p">)</span><span class="w">
</span><span class="s2">"""
  (Intercept)           age      I(age^2)      I(age^3)      I(age^4) 
-1.841542e+02  2.124552e+01 -5.638593e-01  6.810688e-03 -3.203830e-05 
"""</span><span class="w">

</span><span class="n">fit2b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">wage</span><span class="o">~</span><span class="n">cbind</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="n">age</span><span class="o">^</span><span class="m">2</span><span class="p">,</span><span class="n">age</span><span class="o">^</span><span class="m">3</span><span class="p">,</span><span class="n">age</span><span class="o">^</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">fit2b</span><span class="p">)</span><span class="w">


</span><span class="n">agelims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">range</span><span class="p">(</span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="c1">#r 에서 range는 범위를 나타낸다.</span><span class="w">
</span><span class="n">age.grid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="n">from</span><span class="o">=</span><span class="n">agelims</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">to</span><span class="o">=</span><span class="n">agelims</span><span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">preds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="n">age.grid</span><span class="p">),</span><span class="w"> </span><span class="n">se</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">se.bands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">preds</span><span class="o">$</span><span class="n">fit</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">2</span><span class="o">*</span><span class="n">preds</span><span class="o">$</span><span class="n">se.fit</span><span class="p">,</span><span class="n">preds</span><span class="o">$</span><span class="n">fit</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">2</span><span class="o">*</span><span class="n">preds</span><span class="o">$</span><span class="n">se.fit</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">se.bands</span><span class="w"> </span><span class="c1">#예측값에 대한 신뢰구간 코딩으로 직접 구하기.</span><span class="w">



</span><span class="c1"># polynomial 의 차수를 결정하기위해 anova를 사용하자</span><span class="w">
</span><span class="c1">#단 여기서 각 모델은 nested model이어야.</span><span class="w">

</span><span class="n">fit.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">wage</span><span class="o">~</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">fit.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">wage</span><span class="o">~</span><span class="n">poly</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">fit.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">wage</span><span class="o">~</span><span class="n">poly</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">fit.4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">wage</span><span class="o">~</span><span class="n">poly</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">fit.5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">wage</span><span class="o">~</span><span class="n">poly</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">anova</span><span class="p">(</span><span class="n">fit.1</span><span class="p">,</span><span class="w"> </span><span class="n">fit.2</span><span class="p">,</span><span class="w"> </span><span class="n">fit.3</span><span class="p">,</span><span class="n">fit.4</span><span class="p">,</span><span class="n">fit.5</span><span class="p">)</span><span class="w">

</span><span class="c1">#anova 메소드를 사용한 결과는 orthogonal poly와 결과가 같다.</span><span class="w">
</span><span class="c1">#즉 coef(summary(fit)) 또한 동일한 p-value와 동일한 t-statistic ^2 = F-statistic 을 가지고 있다. </span><span class="w">

</span><span class="c1">#로지스틱에서도 polynomial을 사용할 수 있다.</span><span class="w">
</span><span class="n">fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="n">wage</span><span class="o">&gt;</span><span class="m">250</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">poly</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">Wage</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">binomial</span><span class="p">)</span><span class="w">
</span><span class="n">preds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="n">age.grid</span><span class="p">),</span><span class="w"> </span><span class="n">se</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="w">
</span><span class="c1">#여기서 나온 preds 값은 logit 값이므로 이를 바꾼다. </span><span class="w">
</span><span class="n">pfit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">preds</span><span class="o">$</span><span class="n">fit</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="o">+</span><span class="nf">exp</span><span class="p">(</span><span class="n">preds</span><span class="o">$</span><span class="n">fit</span><span class="p">))</span><span class="w">
</span><span class="n">pfit</span><span class="w">

</span><span class="c1">#위와 같은 논리를 간단한 코드로 나타낼 수 있다. family = binomial 이므로 type=response 만 주면 확률값이 나온다.</span><span class="w">
</span><span class="n">preds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="n">age.grid</span><span class="p">),</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"response"</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="w">
</span><span class="n">preds</span><span class="w">

</span><span class="c1">#로지스틱 신뢰구간 만들기</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="n">I</span><span class="p">(</span><span class="n">wage</span><span class="o">&gt;</span><span class="m">250</span><span class="p">),</span><span class="w"> </span><span class="n">xlim</span><span class="o">=</span><span class="n">agelims</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">.2</span><span class="p">))</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">jitter</span><span class="p">(</span><span class="n">age</span><span class="p">),</span><span class="w"> </span><span class="n">I</span><span class="p">((</span><span class="n">wage</span><span class="o">&gt;</span><span class="m">250</span><span class="p">)</span><span class="o">/</span><span class="m">5</span><span class="p">),</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">.5</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"darkgray"</span><span class="p">)</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">age.grid</span><span class="p">,</span><span class="w"> </span><span class="n">pfit</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span><span class="w">
</span><span class="n">matlines</span><span class="p">(</span><span class="n">age.grid</span><span class="p">,</span><span class="n">se.bands</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"green"</span><span class="p">)</span><span class="w">
</span><span class="n">se.bands</span><span class="w">

</span><span class="c1">#step function -- use cut() function</span><span class="w">
</span><span class="n">table</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="m">4</span><span class="p">))</span><span class="w">
</span><span class="n">fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">wage</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">cut</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">))</span><span class="w"> </span><span class="c1">#dummy 이므로 4개로 구간 cutting 하면 변수는 3개</span><span class="w">

</span><span class="s2">"""
                        Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)            94.158392   1.476069 63.789970 0.000000e+00
cut(age, 4)(33.5,49]   24.053491   1.829431 13.148074 1.982315e-38
cut(age, 4)(49,64.5]   23.664559   2.067958 11.443444 1.040750e-29
cut(age, 4)(64.5,80.1]  7.640592   4.987424  1.531972 1.256350e-01
"""</span><span class="w">


</span><span class="c1">## spline regression</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">splines</span><span class="p">)</span><span class="w">
</span><span class="n">fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">wage</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">bs</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">knots</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">25</span><span class="p">,</span><span class="m">40</span><span class="p">,</span><span class="m">60</span><span class="p">)),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w"> </span><span class="c1">#spline은 basis function을 만드는 bs 명령어를 준다.</span><span class="w">
</span><span class="n">pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="n">age.grid</span><span class="p">),</span><span class="w"> </span><span class="n">se</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">wage</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'gray'</span><span class="p">)</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">age.grid</span><span class="p">,</span><span class="w"> </span><span class="n">pred</span><span class="o">$</span><span class="n">fit</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">age.grid</span><span class="p">,</span><span class="w"> </span><span class="n">pred</span><span class="o">$</span><span class="n">fit</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">2</span><span class="o">*</span><span class="n">pred</span><span class="o">$</span><span class="n">se</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"dashed"</span><span class="p">)</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">age.grid</span><span class="p">,</span><span class="w"> </span><span class="n">pred</span><span class="o">$</span><span class="n">fit</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">2</span><span class="o">*</span><span class="n">pred</span><span class="o">$</span><span class="n">se</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"dashed"</span><span class="p">)</span><span class="w">

</span><span class="c1">#knots를 data의 uniform quantile로 주고 싶다면</span><span class="w">
</span><span class="n">bs</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">=</span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="c1"># 왜 6인가? cubic spline에서는knot가 3개 일때 자유도가 7인데 intercept를 제외하고 6이 되는 것.</span><span class="w">
</span><span class="n">fit2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">wage</span><span class="o">~</span><span class="n">bs</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w">


</span><span class="c1">## smoothing spline -- smooth.spline() 사용</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">wage</span><span class="p">,</span><span class="w"> </span><span class="n">xlims</span><span class="o">=</span><span class="n">agelims</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.5</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'darkgrey'</span><span class="p">)</span><span class="w">
</span><span class="n">fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smooth.spline</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">wage</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">=</span><span class="m">16</span><span class="p">)</span><span class="w">
</span><span class="n">fit2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smooth.spline</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">wage</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">fit2</span><span class="o">$</span><span class="n">df</span><span class="w"> </span><span class="c1">#6.8 즉 cv를 통해서 rss를 가장 작게하는 smoothness level을 결정.</span><span class="w">

</span><span class="n">lines</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">fit2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span><span class="w">



</span><span class="c1">##local regression -- loess() 사용</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">wage</span><span class="p">,</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">agelims</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">.5</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'darkgrey'</span><span class="p">)</span><span class="w">
</span><span class="n">fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loess</span><span class="p">(</span><span class="n">wage</span><span class="o">~</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">span</span><span class="o">=</span><span class="m">.2</span><span class="p">,</span><span class="w"> </span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">fit2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loess</span><span class="p">(</span><span class="n">wage</span><span class="o">~</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">span</span><span class="o">=</span><span class="m">.5</span><span class="p">,</span><span class="w"> </span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">age.grid</span><span class="p">,</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="n">data.frame</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="n">age.grid</span><span class="p">)),</span><span class="n">col</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">age.grid</span><span class="p">,</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">fit2</span><span class="p">,</span><span class="n">data.frame</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="n">age.grid</span><span class="p">)),</span><span class="n">col</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span><span class="w">


</span><span class="c1">## GAMs</span><span class="w">
</span><span class="c1"># big linear regression model using basis function 인 경우</span><span class="w">
</span><span class="n">gam1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">wage</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">bs</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bs</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">education</span><span class="p">,</span><span class="w"> </span><span class="n">Wage</span><span class="p">)</span><span class="w">

</span><span class="c1"># smoothing spline을사용한 GAMs -- gam 라이브러리 사용</span><span class="w">

</span><span class="n">library</span><span class="p">(</span><span class="n">gam</span><span class="p">)</span><span class="w">
</span><span class="n">gam.m3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gam</span><span class="p">(</span><span class="n">wage</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="o">+</span><span class="n">s</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="m">5</span><span class="p">)</span><span class="o">+</span><span class="n">education</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">gam.m3</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">)</span><span class="w">
</span><span class="c1">#par(mfrow=c(1,1))</span><span class="w">

</span><span class="n">plot.gam</span><span class="p">(</span><span class="n">gam1</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span><span class="w"> </span><span class="c1">#plot.gam 은 gam,lm 모두 사용 가능</span><span class="w">

</span><span class="n">summary</span><span class="p">(</span><span class="n">gam.m3</span><span class="p">)</span><span class="w">
</span><span class="n">preds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">gam.m3</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Wage</span><span class="p">)</span><span class="w">

</span><span class="c1">#gam을 building 하는 데에 local regression 쓸수도 있음.</span><span class="w">
</span><span class="n">gam.io</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gam</span><span class="p">(</span><span class="n">wage</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">=</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lo</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">span</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">education</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">gam.io.i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gam</span><span class="p">(</span><span class="n">wage</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">lo</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">span</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">education</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w"> </span><span class="c1">#localregression 과정에서 interaction term 넣기</span><span class="w">

</span><span class="n">library</span><span class="p">(</span><span class="n">akima</span><span class="p">)</span><span class="w"> </span><span class="c1">#two-dimenstional surface 볼 수 있는 package</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">gam.io.i</span><span class="p">)</span><span class="w">

</span><span class="c1">#logistic GAMs</span><span class="w">
</span><span class="n">gam.lr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gam</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="n">wage</span><span class="o">&gt;</span><span class="m">250</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="m">5</span><span class="p">)</span><span class="o">+</span><span class="n">education</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">binomial</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">gam.lr</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="o">=</span><span class="nb">T</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'green'</span><span class="p">)</span><span class="w">

</span></pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/datascience/" class="post-tag no-text-decoration" >datascience</a> <a href="/tags/datamining/" class="post-tag no-text-decoration" >datamining</a> <a href="/tags/machinelearning/" class="post-tag no-text-decoration" >machinelearning</a> <a href="/tags/islr/" class="post-tag no-text-decoration" >ISLR</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ISLR - LAB7 - For Statistics&url=https://hwankam.github.io/posts/ISLR7-LAB/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ISLR - LAB7 - For Statistics&u=https://hwankam.github.io/posts/ISLR7-LAB/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=ISLR - LAB7 - For Statistics&url=https://hwankam.github.io/posts/ISLR7-LAB/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/PRML6/">PRML-6</a><li><a href="/posts/PRML5/">PRML-5</a><li><a href="/posts/PRML4/">PRML-4</a><li><a href="/posts/PRML3/">PRML-3</a><li><a href="/posts/CASI9/">Computer Age Statistical Inference - chap 9</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/datamining/">datamining</a> <a class="post-tag" href="/tags/machinelearning/">machinelearning</a> <a class="post-tag" href="/tags/islr/">ISLR</a> <a class="post-tag" href="/tags/statistical-method/">statistical method</a> <a class="post-tag" href="/tags/efron/">Efron</a> <a class="post-tag" href="/tags/prml/">PRML</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/categorical-data/">categorical data</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ISLR2/"><div class="card-body"> <span class="timeago small" >Jul 29, 2021<i class="unloaded">2021-07-29T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ISLR chap 2</h3><div class="text-muted small"><p> 2.1 What is statistical learning? 2.1.1 X : predictor, features, independent variable Y : response, dependent variable $ Y = f(X) + \epsilon $ $ \hat Y = \hat f(X) $ reducible error : Y를 ...</p></div></div></a></div><div class="card"> <a href="/posts/ISLR2-LAB/"><div class="card-body"> <span class="timeago small" >Jul 30, 2021<i class="unloaded">2021-07-30T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ISLR - LAB2</h3><div class="text-muted small"><p> R 코드 정리 #할당, c는 백터를 의미 x &lt;- c(1,2,3,4) # 백터의 원소 개수 length(x) #저장되어 있는 변수 모두 호출 ls() #remove rm(x) rm(list=ls()) #행렬 x = matrix(data=c(1,2,3,4), nrow=2, ncol=2) x y = matrix(data=c(1,2,3,4), nr...</p></div></div></a></div><div class="card"> <a href="/posts/ISLR3-LAB/"><div class="card-body"> <span class="timeago small" >Jul 30, 2021<i class="unloaded">2021-07-30T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ISLR - LAB3</h3><div class="text-muted small"><p> R 코드 정리 library(MASS) fix(Boston) #table 형태로 보여주기 names(Boston) # 열 이름 보여주기 attach(Boston) lm.fit = lm( medv ~ lstat) summary(lm.fit) """ Call: lm(formula = medv ~ lstat) Residuals: Min ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/MCMC/" class="btn btn-outline-primary" prompt="Older"><p>MCMC</p></a> <a href="/posts/ISLR8-LAB/" class="btn btn-outline-primary" prompt="Newer"><p>ISLR - LAB8</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/datamining/">datamining</a> <a class="post-tag" href="/tags/machinelearning/">machinelearning</a> <a class="post-tag" href="/tags/islr/">ISLR</a> <a class="post-tag" href="/tags/statistical-method/">statistical method</a> <a class="post-tag" href="/tags/efron/">Efron</a> <a class="post-tag" href="/tags/prml/">PRML</a> <a class="post-tag" href="/tags/machine-learning/">machine learning</a> <a class="post-tag" href="/tags/machine-learning/">Machine learning</a> <a class="post-tag" href="/tags/categorical-data/">categorical data</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}}); </script> MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) { alert("Math Processing Error: "+message[1]); }); MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) { alert("Math Processing Error: "+message[1]); }); </script> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
